<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</title>
    <link rel="icon" type="image/png" href="Logo.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&family=Inter:wght@400;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">

</head>

<body>
    <div id="saveModal" class="modal-overlay">
        <div class="custom-modal">
            <h3 style="margin-bottom: 15px;">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
            <p style="font-size: 0.9rem; color: #6b7280; margin-bottom: 10px;">‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:</p>
            <input type="text" id="modalInput"
                style="width:100%; padding:10px; border-radius:8px; border:1px solid #ddd; margin-bottom: 20px;">
            <div style="display:flex; gap:10px; justify-content:flex-end;">
                <button onclick="document.getElementById('saveModal').style.display='none'" class="btn"
                    style="width:auto; padding: 8px 20px; background:#f3f4f6;">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button onclick="confirmSaveHistory()" class="btn btn-primary"
                    style="width:auto; padding: 8px 20px;">‡∏ï‡∏Å‡∏•‡∏á</button>
            </div>
        </div>
    </div>

    <div id="loadModal" class="modal-overlay">
        <div class="custom-modal">
            <h3 style="margin-bottom: 15px;">üìÇ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤</h3>
            <p id="loadModalText" style="margin-bottom: 20px;"></p>
            <div style="display:flex; gap:10px; justify-content:flex-end;">
                <button onclick="document.getElementById('loadModal').style.display='none'" class="btn"
                    style="width:auto; padding: 8px 20px; background:#f3f4f6;">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="confirmLoadBtn" class="btn btn-primary"
                    style="width:auto; padding: 8px 20px;">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ</button>
            </div>
        </div>
    </div>

    <div class="history-sidebar no-print">
        <div class="sidebar-header">
            <div class="sidebar-title">üìã ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>
            <select id="fmtSelector" onchange="switchFMT(this.value)"
                style="width: 100%; padding: 8px; margin-top: 10px; border-radius: 8px; border: 1px solid var(--border); font-family: var(--font-main);">
                <option value="01">FMT-01 (‡∏ï‡πâ‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô)</option>
                <option value="02">FMT-02 (‡∏â‡∏µ‡∏î‡πÇ‡∏ü‡∏°‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô)</option>
                <option value="03">FMT-03 (‡∏ô‡∏¥‡πà‡∏á‡πÄ‡∏°‡πá‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô)</option>
                <option value="05">FMT-05 (‡∏õ‡∏±‡πä‡∏°‡∏•‡∏°‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô)</option>
                <option value="06">FMT-06 (‡∏õ‡∏±‡πä‡∏°‡∏™‡∏π‡∏ç‡∏ç‡∏≤‡∏Å‡∏≤‡∏®‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô)</option>
                <option value="37">FMT-37 (‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®)</option>
                <option value="38">FMT-38 (‡∏£‡∏≠‡∏Å‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô)</option>

            </select>
        </div>
        <div class="sidebar-header">
            <div class="sidebar-title">üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</div>
            <div style="font-size: 0.75rem; color: var(--text-sub); margin-top: 5px;">‡∏ù‡πà‡∏≤‡∏¢ / ‡πÅ‡∏ú‡∏ô‡∏Å ‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</div>
        </div>
        <div class="sidebar-actions">
            <input type="checkbox" id="selectAll" onclick="toggleSelectAll(this)" style="cursor: pointer;">
            <label for="selectAll" style="cursor: pointer; font-weight: 600;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
            <button onclick="syncFromCloud()"
                style="margin-left: auto; border: none; background: none; cursor: pointer; color: var(--primary);"
                title="‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Cloud">
                ‚òÅÔ∏è Sync
            </button>
        </div>
        <div class="sidebar-content" id="history-list">
            <!-- Items injected here -->
        </div>
    </div>

    <div class="controls no-print">
        <div id="statusBadge"
            style="padding: 8px; background: #fee2e2; color: #991b1b; font-size: 0.75rem; text-align: center; border-radius: 8px; margin-bottom: 10px; display: none; font-weight: bold; border: 1px solid #fecaca;">
            üëÄ Viewing History</div>

        <button id="editToggleBtn" class="btn" onclick="toggleEditMode()"
            style="display: none; background: #3b82f6; color: white;"><span>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ</span></button>
        <button id="updateBtn" class="btn" onclick="updateCurrentHistory()"
            style="display: none; background: var(--warning); color: white;"><span>üîÑ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°</span></button>
        <button class="btn btn-primary" onclick="saveToHistory()"><span>üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡∏°‡πà</span></button>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
            <button class="btn btn-success" onclick="markAllNormal()"
                style="font-size: 0.75rem; padding: 10px 5px;"><span>‚úÖ ‡∏ï‡∏¥‡πä‡∏Å‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span></button>
            <button class="btn btn-danger" onclick="clearAll()" style="font-size: 0.75rem; padding: 10px 5px;"><span>üóëÔ∏è
                    ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span></button>
        </div>

        <hr style="margin: 15px 0; border: 0; border-top: 1px solid var(--border);">

        <button class="btn btn-primary" onclick="printSelected()" id="printSelectedBtn"
            style="background: #000; display: none;">
            <span>üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span>
        </button>

        <button class="btn btn-outline" onclick="window.print()">
            <span>üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</span>
        </button>
        <div class="drag-handle-bar">‚Ä¢‚Ä¢‚Ä¢</div>
    </div>

    <div id="print-area"></div>


    <div id="forms-container"></div>

    <script>
        let currentFMT = 1;
        let currentLoadedId = null;
        let pendingLoadItem = null;

        // Drag-to-fill variables
        let isDragging = false;
        let dragStartState = 0;
        let dragStartCell = null;

        // Helper functions for Thai dates (Buddhist Era)
        const thaiMonths = [
            '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
            '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
        ];

        function toBuddhistYear(year) {
            return parseInt(year) + 543;
        }

        function formatThaiDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            const day = date.getDate();
            const month = date.getMonth() + 1;
            const year = toBuddhistYear(date.getFullYear());
            return `${day}/${month}/${year}`;
        }

        function toThaiDateStr(dateStr) {
            return formatThaiDate(dateStr);
        }

        function getCurrentThaiYear() {
            return toBuddhistYear(new Date().getFullYear());
        }

        const checklistData37 = [
            {
                category: "‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå",
                items: [
                    { name: "‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ (Moniter)", std: "‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏†‡∏≤‡∏û ‡πÑ‡∏°‡πà‡∏•‡∏≤‡∏¢ ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡∏Å" },
                    { name: "‡∏õ‡∏•‡∏±‡πä‡∏Å‡πÑ‡∏ü", std: "‡πÑ‡∏°‡πà‡∏Ç‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏∑‡πà‡∏≠‡∏¢" },
                    { name: "‡πÅ‡∏õ‡πâ‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå (Keyboard)", std: "‡πÑ‡∏°‡πà‡∏´‡∏•‡∏∏‡∏î‡∏≠‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏ô‡∏°‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô" },
                    { name: "‡∏™‡∏ß‡∏¥‡∏ï‡∏ó‡πå‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥" },
                    { name: "‡∏™‡∏≤‡∏¢‡πÑ‡∏ü", std: "‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö" },
                    { name: "‡∏ä‡πà‡∏≠‡∏á‡∏ï‡πà‡∏≠ UHB", std: "‡πÑ‡∏°‡πà‡∏´‡∏•‡∏ß‡∏°‡πÑ‡∏°‡πà‡∏Ñ‡∏•‡∏≠‡∏ô" },
                    { name: "CPU", std: "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥" },
                    { name: "‡πÄ‡∏°‡∏≤‡∏™‡πå (Mouse)", std: "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏Ñ‡πâ‡∏≤‡∏á" }
                ]
            },
            {
                category: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå",
                items: [
                    { name: "‡∏õ‡∏•‡∏±‡πä‡∏Å‡πÑ‡∏ü", std: "‡πÑ‡∏°‡πà‡∏Ç‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏∑‡πà‡∏≠‡∏¢" },
                    { name: "‡∏™‡∏ß‡∏¥‡∏ï‡∏ó‡πå‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î", std: "‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÑ‡∏ü‡∏ï‡∏¥‡∏î - ‡∏õ‡∏¥‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÑ‡∏ü‡∏î‡∏±‡∏ö" },
                    { name: "‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏á‡∏≤‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå", std: "‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏ô‡∏•‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏£‡∏≠‡∏∞‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô" },
                    { name: "‡∏•‡∏π‡∏Å‡∏Å‡∏•‡∏¥‡πâ‡∏á (Roller)", std: "‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏≤‡∏ö ‡∏á‡∏≤‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏™‡πâ‡∏ô" }
                ]
            },
            {
                category: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô",
                items: [
                    { name: "‡∏à‡∏≠‡∏ß‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£", std: "‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏≤‡∏ö" },
                    { name: "‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏á‡∏≤‡∏ô", std: "‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏ô‡∏•‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏™‡πâ‡∏ô" },
                    { name: "‡∏õ‡∏•‡∏±‡πä‡∏Å‡πÑ‡∏ü", std: "‡πÑ‡∏°‡πà‡∏Ç‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏∑‡πà‡∏≠‡∏¢" },
                    { name: "‡∏™‡∏ß‡∏¥‡∏ï‡∏ó‡πå‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î", std: "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥" }
                ]
            },
            {
                category: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÇ‡∏ó‡∏£‡∏™‡∏≤‡∏£",
                items: [
                    { name: "‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏á‡∏≤‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå", std: "‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏ô‡∏•‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏£‡∏≠‡∏∞‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô" },
                    { name: "‡∏õ‡∏•‡∏±‡πä‡∏Å‡πÑ‡∏ü", std: "‡πÑ‡∏°‡πà‡∏Ç‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏∑‡πà‡∏≠‡∏¢" },
                    { name: "‡∏•‡∏π‡∏Å‡∏Å‡∏•‡∏¥‡πâ‡∏á (Roller)", std: "‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏≤‡∏ö ‡∏á‡∏≤‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏™‡πâ‡∏ô" }
                ]
            }
        ];
        const checklistData38 = [
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏ü‡πâ‡∏≤",
                items: [
                    { name: "‡∏™‡∏ß‡∏¥‡∏ï‡∏ó‡πå ‡∏Å‡∏î‡∏Ç‡∏∂‡πâ‡∏ô-‡∏•‡∏á", std: "‡∏õ‡∏£‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡πÅ‡∏ï‡∏Å / ‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏£‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", std: "‡∏õ‡∏£‡∏Å‡∏ï‡∏¥‡πÑ‡∏°‡πà‡∏Ç‡∏≤‡∏î" },
                    { name: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", std: "‡∏õ‡∏£‡∏Å‡∏ï‡∏¥‡πÑ‡∏°‡πà‡∏£‡πâ‡∏≠‡∏ô , ‡πÑ‡∏°‡πà‡πÑ‡∏´‡∏°‡πâ" },
                    { name: "‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå", std: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á /‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏π‡∏á" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏•",
                items: [
                    { name: "‡πÇ‡∏ã‡πà", std: "‡∏õ‡∏£‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏î ‡πÑ‡∏°‡πà‡∏Ç‡∏≤‡∏î" },
                    { name: "‡∏ä‡∏∏‡∏î‡∏ï‡∏∞‡∏Ç‡∏≠‡∏¢‡∏Å", std: "‡∏õ‡∏£‡∏Å‡∏ï‡∏¥‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "‡∏ñ‡∏∏‡∏á‡πÉ‡∏™‡πà‡πÇ‡∏ã‡πà", std: "‡∏õ‡∏£‡∏Å‡∏ï‡∏¥‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "‡∏ä‡∏∏‡∏î‡∏•‡πâ‡∏≠‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô", std: "‡∏õ‡∏£‡∏Å‡∏ï‡∏¥ ‡∏•‡πá‡∏≠‡∏Ñ‡πÅ‡∏ô‡πà‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏•‡∏ß‡∏°" },
                    { name: "‡∏Ñ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏≤‡∏£‡∏≠‡∏Å", std: "‡∏õ‡∏£‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏Ç‡∏≤‡∏î ‡πÅ‡∏ï‡∏Å" }
                ]
            }
        ];

        const checklistData02 = [
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö SAFETY",
                items: [
                    { name: "‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î ‡∏ã‡πâ‡∏≤‡∏¢-‡∏Ç‡∏ß‡∏≤", std: "‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î ‡πÑ‡∏î‡πâ‡∏™‡∏∞‡∏î‡∏ß‡∏Å" },
                    { name: "Limit switch ‡∏ã‡πâ‡∏≤‡∏¢-‡∏Ç‡∏ß‡∏≤", std: "‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏¢‡∏∏‡∏î-‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏ô" },
                    { name: "‡∏ï‡∏±‡∏ß‡∏•‡πá‡∏≠‡∏Ñ ‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡∏ã‡πâ‡∏≤‡∏¢-‡∏Ç‡∏ß‡∏≤", std: "‡∏•‡πá‡∏≠‡∏Ñ‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà‡∏ô" },
                    { name: "EMERGENCY STOP", std: "‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏¢‡∏∏‡∏î" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏ü‡πâ‡∏≤",
                items: [
                    { name: "‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°", std: "‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏ß‡∏≤‡∏á‡πÄ‡∏Å‡∏∞‡∏Å‡∏∞" },
                    { name: "‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°", std: "‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö ‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ó‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", std: "‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö/ ‡∏£‡πâ‡∏≠‡∏¢‡∏ó‡πà‡∏≠/ ‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "Switch Control", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ ‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏ô‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°", std: "‡πÑ‡∏°‡πà‡∏£‡πâ‡∏≠‡∏ô ‡πÑ‡∏´‡∏°‡πâ ‡∏≠‡∏±‡∏î‡πÅ‡∏ô‡πà‡∏ô" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏Æ‡∏î‡∏£‡∏≠‡∏•‡∏¥‡∏Ñ",
                items: [
                    { name: "Solenoid Valve", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" },
                    { name: "‡∏Å‡∏£‡∏∞‡∏ö‡∏≠‡∏Å‡∏™‡∏π‡∏ö", std: "‡∏¢‡∏∂‡∏î‡πÅ‡∏ô‡πà‡∏ô ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" },
                    { name: "‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô Mold press", std: "‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ñ‡πà‡∏≤ 80-120 ‡∏ö‡∏≤‡∏£‡πå" },
                    { name: "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô", std: "‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö Steam",
                items: [
                    { name: "Valve Steam", std: "‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î ‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" },
                    { name: "Pressur gauge contactor", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏î-‡∏ï‡πà‡∏≠ ‡∏õ‡∏Å‡∏ï‡∏¥" },
                    { name: "Glove Valve", std: "‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î ‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" },
                    { name: "Pressur gauge contactor", std: "‡∏™‡∏≤‡∏¢‡∏™‡∏ï‡∏£‡∏µ‡∏°‡πÑ‡∏°‡πà‡πÅ‡∏ï‡∏Å ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏°",
                items: [
                    { name: "Solenoid Valve", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" },
                    { name: "‡∏™‡∏≤‡∏¢‡∏•‡∏°", std: "‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß ‡πÑ‡∏°‡πà‡πÅ‡∏ï‡∏Å" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡πâ‡∏≥",
                items: [
                    { name: "Solenoid Valve", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏•",
                items: [
                    { name: "‡πÄ‡∏û‡∏•‡∏≤‡∏ï‡πà‡∏≤‡∏á ‡πÜ", std: "‡∏°‡∏µ‡∏à‡∏≤‡∏£‡∏∞‡∏ö‡∏µ ‡πÑ‡∏°‡πà‡πÇ‡∏Ñ‡πâ‡∏á‡∏á‡∏≠" }
                ]
            }
        ];
        const checklistData03 = [
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏ü‡πâ‡∏≤",
                items: [
                    { name: "‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°", std: "‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏∑‡πà‡∏ô‡∏ß‡∏≤‡∏á" },
                    { name: "‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°", std: "‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö ‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏£‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", std: "‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö/ ‡∏£‡πâ‡∏≠‡∏¢‡∏ó‡πà‡∏≠/ ‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ ‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°", std: "‡πÑ‡∏°‡πà‡∏£‡πâ‡∏≠‡∏ô ‡πÑ‡∏´‡∏°‡πâ ‡∏¢‡∏∂‡∏î‡πÅ‡∏ô‡πà‡∏ô" },
                    { name: "‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á" },
                    { name: "‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏ü‡∏™‡πà‡∏≠‡∏á‡∏ñ‡∏±‡∏á", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏≠‡∏ô‡πâ‡∏≥ (Steam)",
                items: [
                    { name: "Valve Steam", std: "‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î ‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" },
                    { name: "Reducing valve (‡∏ß‡∏≤‡∏•‡πå‡∏ß‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô)", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏î-‡∏ï‡πà‡∏≠ ‡∏õ‡∏Å‡∏ï‡∏¥" },
                    { name: "‡∏™‡∏ï‡∏£‡∏µ‡∏°‡πÅ‡∏ó‡∏£‡πá‡∏õ", std: "‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î ‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏°",
                items: [
                    { name: "Solenoid Valve", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" },
                    { name: "‡∏Å‡∏£‡∏∞‡∏ö‡∏≠‡∏Å‡∏•‡∏° ‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î ‡πÄ‡∏°‡πá‡∏î‡∏•‡∏á", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" },
                    { name: "‡∏ß‡∏≤‡∏•‡πå‡∏ß ‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î ‡πÄ‡∏°‡πá‡∏î‡∏•‡∏á", std: "‡∏õ‡∏¥‡∏î-‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏•",
                items: [
                    { name: "‡πÄ‡∏û‡∏•‡∏≤‡∏ï‡πà‡∏≤‡∏á ‡πÜ", std: "‡∏°‡∏µ‡∏à‡∏≤‡∏£‡∏ö‡∏µ ‡πÑ‡∏°‡πà‡πÑ‡∏Å‡πà‡∏á‡∏≠" }
                ]
            }
        ];
        const checklistData05 = [
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö SAFETY",
                items: [
                    { name: "‡∏ï‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏π‡∏á", std: "120 C ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ" },
                    { name: "‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô", std: "‡∏ï‡∏±‡∏î 7 ‡∏ö‡∏≤‡∏£‡πå ‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà 6 ‡∏ö‡∏≤‡∏£‡πå" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏ü‡πâ‡∏≤",
                items: [
                    { name: "‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°", std: "‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏∑‡πà‡∏ô‡∏ß‡∏≤‡∏á" },
                    { name: "‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°", std: "‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö ‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏£‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", std: "‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö/ ‡∏£‡πâ‡∏≠‡∏¢‡∏ó‡πà‡∏≠/ ‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°", std: "‡πÑ‡∏°‡πà‡∏£‡πâ‡∏≠‡∏ô /‡πÑ‡∏´‡∏°‡πâ /‡∏¢‡∏∂‡∏î‡πÅ‡∏ô‡πà‡∏ô" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô",
                items: [
                    { name: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô", std: "‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 105 C" },
                    { name: "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô", std: "‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏µ‡∏î‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß" },
                    { name: "‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ï‡πà‡∏≤‡∏á ‡πÜ", std: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡∏ã‡∏∂‡∏°" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏°",
                items: [
                    { name: "‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏á‡∏•‡∏°", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß" },
                    { name: "‡∏ï‡∏∞‡πÅ‡∏Å‡∏£‡∏á‡∏Å‡∏£‡∏≠‡∏á‡∏•‡∏°‡πÄ‡∏Ç‡πâ‡∏≤", std: "‡∏™‡∏∞‡∏≠‡∏≤‡∏î" },
                    { name: "‡∏£‡∏±‡∏á‡∏ú‡∏∂‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô", std: "‡∏™‡∏∞‡∏≠‡∏≤‡∏î" },
                    { name: "‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏ô‡πâ‡∏≥", std: "‡πÑ‡∏°‡πà‡∏≠‡∏∏‡∏î‡∏ï‡∏±‡∏ô‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡πÑ‡∏´‡∏•" }
                ]
            }
        ];
        const checklistData06 = [
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏ü‡πâ‡∏≤",
                items: [
                    { name: "‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°", std: "‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏∑‡πà‡∏ô‡∏ß‡∏≤‡∏á" },
                    { name: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°", std: "‡πÑ‡∏°‡πà‡∏£‡πâ‡∏≠‡∏ô /‡πÑ‡∏´‡∏°‡πâ /‡∏¢‡∏∂‡∏î‡πÅ‡∏ô‡πà‡∏ô" },
                    { name: "‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤", std: "‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö/ ‡∏£‡πâ‡∏≠‡∏¢‡∏ó‡πà‡∏≠/ ‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î" },
                    { name: "‡∏™‡∏≤‡∏¢‡∏û‡∏≤‡∏ô", std: "‡∏ï‡∏∂‡∏á‡πÑ‡∏°‡πà‡∏´‡∏¢‡πà‡∏≠‡∏ô" },
                    { name: "‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå", std: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á /‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏π‡∏á" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡πâ‡∏≥",
                items: [
                    { name: "‡∏ô‡πâ‡∏≥‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏õ‡∏±‡πä‡∏°", std: "‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏ô‡πâ‡∏≥‡∏°‡∏µ‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥" },
                    { name: "‡∏õ‡∏±‡πä‡∏°‡∏î‡∏π‡∏î‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ñ‡∏±‡∏á", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô",
                items: [
                    { name: "‡∏õ‡∏±‡πä‡∏°‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥" },
                    { name: "‡∏Ñ‡∏π‡∏•‡∏•‡∏¥‡πà‡∏á‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô", std: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏£‡∏±‡πà‡∏ß‡∏ô‡πâ‡∏≥‡πÑ‡∏´‡∏•‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥" }
                ]
            },
            {
                category: "‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏±‡πä‡∏°‡∏™‡∏π‡∏ç‡∏ç‡∏≤‡∏Å‡∏≤‡∏®",
                items: [
                    { name: "‡πÄ‡∏™‡∏µ‡∏¢‡∏á", std: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥" },
                    { name: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô", std: "‡πÉ‡∏ä‡πâ‡∏°‡∏∑‡∏≠‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏£‡πâ‡∏≠‡∏ô" },
                    { name: "‡πÅ‡∏£‡∏á‡∏î‡∏π‡∏î", std: "‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 300 ‡∏ô‡∏¥‡πâ‡∏ß‡∏õ‡∏£‡∏≠‡∏ó" }
                ]
            }
        ];

        window.addEventListener('load', () => {
            renderHistoryList();
            renderAllTables();
        });

        function switchFMT(val) {
            currentFMT = parseInt(val);
            renderAllTables();
            renderHistoryList();
        }

        function renderAllTables() {
            document.getElementById('forms-container').innerHTML = '';
            if (currentFMT === 1) {
                renderExactTable01();
            } else if (currentFMT === 37) {
                renderExactTable37(1);
                renderExactTable37(21);
                renderExactTable37(41);
            } else if (currentFMT === 2) {
                renderExactTable02();
            } else if (currentFMT === 3) {
                renderExactTable03();
            } else if (currentFMT === 5) {
                renderExactTable05();
            } else if (currentFMT === 6) {
                renderExactTable06();
            } else if (currentFMT === 38) {
                renderExactTable38();
            }
        }

        function toThaiDigits(str) {
            return str;
        }

        function toThaiDateStr(dateStr) {
            if (!dateStr) return "";
            const d = new Date(dateStr);
            if (isNaN(d)) return dateStr;
            const day = d.getDate();
            const month = d.getMonth() + 1;
            const year = d.getFullYear() + 543;
            return `${day}/${month}/${year}`;
        }


        function renderExactTable37(startNum) {
            const div = document.createElement('div');
            div.className = 'sheet-container';

            let machineHeaders = '';
            for (let i = 0; i < 20; i++) {
                let num = startNum + i;
                let isExist = num <= 54;
                machineHeaders += `<th style="width: 28px; text-align: center; cursor: ${isExist ? 'pointer' : 'default'}" ${isExist ? `onclick="toggleColumn(${num})"` : ''}>${isExist ? num : ''}</th>`;
            }

            let rowsHtml = '';
            checklistData37.forEach(group => {
                group.items.forEach((item, idx) => {
                    rowsHtml += `<tr>
                        ${idx === 0 ? `<td rowspan="${group.items.length}" class="category-cell" style="width: 30px;"><div class="vertical-text" style="font-weight:bold; width: 20px;">${group.category}</div></td>` : ''}
                        <td class="col-item" style="font-size:0.75rem; width: 150px; text-align: left; padding-left: 5px;">${item.name}</td>
                        <td class="col-std" style="font-size:0.7rem; width: 220px; text-align: left; padding-left: 5px;">${item.std}</td>`;
                    for (let i = 0; i < 20; i++) {
                        let num = startNum + i;
                        let isExist = num <= 54;
                        rowsHtml += `<td class="check-cell mach-${num}" data-state="0" data-num="${num}" style="background: ${isExist ? '#fff' : '#f8fafc'}; cursor: ${isExist ? 'pointer' : 'default'}; pointer-events: ${isExist ? 'auto' : 'none'}; border: 1px solid #000;"></td>`;
                    }
                    rowsHtml += `<td contenteditable="true" class="row-remark" style="width: 60px; border: 1px solid #000;"></td></tr>`;
                });
            });

            div.innerHTML = `
                <table style="width: 100%; border-collapse: collapse; border: 1px solid #000; margin-bottom: 0;">
                    <tr>
                        <td style="width: 25%; border: 1px solid #000; padding: 5px; text-align: center;">
                            <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                                <img src="Logo.png" alt="Logo" style="height: 30px;">
                                <b style="font-size: 0.85rem;">POLYFOAM HIGH-TECH (PFH)</b>
                            </div>
                        </td>
                        <td style="width: 55%; border: 1px solid #000; padding: 5px; text-align: center; font-size: 1.1rem; font-weight: bold;">
                            ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®
                        </td>
                        <td style="width: 20%; border: 1px solid #000; padding: 5px; text-align: right; font-size: 0.7rem;">
                            ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà.. FMT-37Re#0
                        </td>
                    </tr>
                </table>

                <table class="main-table" style="margin-top: 0; border-top: none; width: 100%;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width: 30px; border: 1px solid #000;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            <th rowspan="2" style="width: 150px; border: 1px solid #000;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                            <th rowspan="2" style="width: 220px; border: 1px solid #000;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                            <th colspan="20" style="text-align: center; border: 1px solid #000;">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</th>
                            <th rowspan="2" style="width: 60px; border: 1px solid #000;">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                        </tr>
                        <tr>${machineHeaders}</tr>
                    </thead>
                    <tbody>${rowsHtml}</tbody>
                </table>

                <div style="border: 1px solid #000; border-top: none; padding: 5px; font-size: 0.75rem;">
                    ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                    <div class="correction-input" contenteditable="true" style="min-height: 40px; border: 1px dashed #ccc; margin-top: 4px; padding: 4px;"></div>
                </div>

                <div style="display: flex; border: 1px solid #000; border-top: none;">
                    <div style="flex: 2; padding: 10px;">
                        <div style="font-weight: bold; margin-bottom: 8px;">
                            ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                        </div>
                        <div style="font-size: 0.75rem; line-height: 1.4;">
                            ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                        </div>
                    </div>
                    <div style="flex: 1.5; border-left: 1px solid #000;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                            <tr style="height: 25px;">
                                <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                <td style="border-bottom: 1px solid #000; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                            </tr>
                            <tr style="height: 35px;">
                                <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                <td style="border-right: 1px solid #000; border-bottom: 1px solid #000;"></td>
                                <td style="border-right: 1px solid #000; border-bottom: 1px solid #000;"></td>
                                <td style="border-bottom: 1px solid #000;"></td>
                            </tr>
                            <tr style="height: 25px;">
                                <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; font-size: 0.6rem;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                <td style="border-bottom: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                            </tr>
                            <tr style="height: 25px;">
                                <td style="border-right: 1px solid #000; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                <td style="border-right: 1px solid #000; text-align: center; padding: 2px;">
                                    <span class="thai-date-display" style="font-size: 0.6rem;"></span>
                                    <input type="date" class="date-input" onchange="this.previousElementSibling.innerText = toThaiDateStr(this.value)" style="width: 100%; border: none; font-size: 0.6rem;">
                                </td>
                                <td style="border-right: 1px solid #000; text-align: center; padding: 2px;">
                                    <span class="thai-date-display" style="font-size: 0.6rem;"></span>
                                    <input type="date" class="date-input" onchange="this.previousElementSibling.innerText = toThaiDateStr(this.value)" style="width: 100%; border: none; font-size: 0.6rem;">
                                </td>
                                <td style="text-align: center; padding: 2px;">
                                    <span class="thai-date-display" style="font-size: 0.6rem;"></span>
                                    <input type="date" class="date-input" onchange="this.previousElementSibling.innerText = toThaiDateStr(this.value)" style="width: 100%; border: none; font-size: 0.6rem;">
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>`;
            document.getElementById('forms-container').appendChild(div);
        }

        function renderExactTable02() {
            const div = document.createElement('div');
            div.className = 'sheet-container';

            let dateHeaders = '';
            for (let i = 1; i <= 31; i++) {
                dateHeaders += `<th style="width: 20px; text-align: center; cursor: pointer" onclick="toggleColumn(${i})">${i}</th>`;
            }

            let rowsHtml = '';
            checklistData02.forEach(group => {
                // Category Header Row
                rowsHtml += `<tr style="background: #fdfdfd;">
                    <td colspan="2" style="text-align: left; font-weight: bold; padding-left: 5px; font-size: 0.8rem; height: 22px; border: 1px solid #000;">${group.category}</td>
                    ${Array(31).fill('<td style="border: 1px solid #000; background: #fafafa;"></td>').join('')}
                </tr>`;

                group.items.forEach((item, idx) => {
                    rowsHtml += `<tr>
                        <td class="col-item" style="font-size:0.75rem; padding-left: 15px; border: 1px solid #000;">${item.name}</td>
                        <td class="col-std" style="font-size:0.7rem; border: 1px solid #000;">${item.std}</td>`;
                    for (let i = 1; i <= 31; i++) {
                        rowsHtml += `<td class="check-cell mach-${i}" data-state="0" data-num="${i}" style="border: 1px solid #000;"></td>`;
                    }
                    rowsHtml += `</tr>`;
                });
            });

            const thaiDate = new Date().toLocaleDateString('th-TH', { year: 'numeric', month: 'long' });

            div.innerHTML = `
                <div style="border-left: 1px solid #000; margin-bottom: 0;">
                    <div class="form-header"  display: flex; align-items: stretch;">
                        <div class="logo-box" style="padding: 5px 15px; width: auto; flex: 1.2; display: flex; flex-direction: row; gap: 10px; align-items: center;">
                            <img src="Logo.png" alt="Logo" style="height: 30px; width: auto;">
                            <div class="company-name" style="font-size: 1rem; font-weight: 700;">POLYFOAM HIGH-TECH (PFH)</div>
                        </div>

                        <div class="form-title" style="flex: 2; display: flex; align-items: center; justify-content: center; padding: 10px; font-size: 1rem; font-weight: 700; text-align: center;">
                            ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏â‡∏µ‡∏î‡πÇ‡∏ü‡∏°‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
                        </div>

                        <div style="flex: 1.2; padding: 6px 10px; display: flex; align-items: center; gap: 6px; font-size: 0.7rem;">
                            <b>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</b>
                            <select class="fmt02-month-select" style="padding: 2px 4px; border: 1px solid #000; font-size: 0.65rem;">
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                                ${thaiMonths.map((m, i) => `<option value="${i + 1}">${m}</option>`).join('')}
                            </select>
                            <select class="fmt02-year-select" style="padding: 2px 4px; border: 1px solid #000; font-size: 0.65rem;">
                                <option value="">‡∏õ‡∏µ</option>
                                ${Array.from({ length: 10 }, (_, i) => getCurrentThaiYear() - 5 + i).map(y => `<option value="${y}">${y}</option>`).join('')}
                            </select>
                            <b style="margin-left: auto;">FMT-02</b>
                            <b style="margin-left: 10px;">Re:#0</b>
                        </div>
                    </div>
                    

                    <div style="display: flex; border-bottom: 1px solid #000; font-size: 0.8rem;">
                        <div style="flex: 1; padding: 6px 10px; border-right: 1px solid #000;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç / Machine No.: <span contenteditable="true" class="fmt02-m-no" style="border-bottom: 1px solid #000; display: inline-block; min-width: 80px;"></span></div>
                        <div style="flex: 1.5; padding: 6px 10px; border-right: 1px solid #000;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£/Machine Name : <span style="font-weight: bold;">INJECTION MOLDING FOAM</span></div>
                        <div style="flex: 1; padding: 6px 10px; border-right: 1px solid #000;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: <span style="font-weight: bold;">‡πÅ‡∏ú‡∏ô‡∏Å‡∏ú‡∏•‡∏¥‡∏ï<span></div>
                        

                    </div>
                </div>

                <table class="main-table" style="font-size: 0.65rem; border-top: none;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width:130px;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                            <th rowspan="2" style="width:130px;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                            <th colspan="31">Date/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        </tr>
                        <tr>${dateHeaders}</tr>
                    </thead>
                    <tbody>${rowsHtml}</tbody>
                </table>
                <div style="border: 2px solid #000; border-top: none; padding: 0; margin-top: 0;">
                    <div style="display:flex;">
                        <div style="flex: 2; padding: 10px 15px; border-right: 2px solid #000; display: flex; flex-direction: column; gap: 8px;">
                            <div style="font-size: 0.85rem; font-weight: bold;">
                                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                            </div>
                            <div style="font-size: 0.75rem; line-height: 1.4;">
                                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡∏•‡∏ß‡πÑ‡∏´‡∏•‡∏´‡∏•‡∏±‡πà‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </div>
                        </div>
                        <div style="flex: 1.2; padding: 0;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-top: none; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                    <td style="border: 1px solid #000; border-right: none; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                                </tr>
                                <tr style="height: 35px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000; border-right: none;"></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center; font-size: 0.65rem;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; border-right: none; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-bottom: none; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-right: none; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>`;
            document.getElementById('forms-container').appendChild(div);
        }
        function renderExactTable03() {
            const div = document.createElement('div');
            div.className = 'sheet-container';

            let dateHeaders = '';
            for (let i = 1; i <= 31; i++) {
                dateHeaders += `<th style="width: 20px; text-align: center; cursor: pointer" onclick="toggleColumn(${i})">${i}</th>`;
            }

            let rowsHtml = '';
            checklistData03.forEach(group => {
                // Category Header Row
                rowsHtml += `<tr style="background: #fdfdfd;">
                    <td colspan="2" style="text-align: left; font-weight: bold; padding-left: 5px; font-size: 0.8rem; height: 22px; border: 1px solid #000;">${group.category}</td>
                    ${Array(31).fill('<td style="border: 1px solid #000; background: #fafafa;"></td>').join('')}
                </tr>`;

                group.items.forEach((item, idx) => {
                    rowsHtml += `<tr>
                        <td class="col-item" style="font-size:0.75rem; padding-left: 15px; border: 1px solid #000;">${item.name}</td>
                        <td class="col-std" style="font-size:0.7rem; border: 1px solid #000;">${item.std}</td>`;
                    for (let i = 1; i <= 31; i++) {
                        rowsHtml += `<td class="check-cell mach-${i}" data-state="0" data-num="${i}" style="border: 1px solid #000;"></td>`;
                    }
                    rowsHtml += `</tr>`;
                });
            });

            div.innerHTML = `
                <div style="border-left: 1px solid #000; margin-bottom: 0;">
                    <div class="form-header" style="display: flex; align-items: stretch;">
                        <div class="logo-box" style="padding: 5px 15px; width: auto; flex: 1.2; display: flex; flex-direction: row; gap: 10px; align-items: center;">
                            <img src="Logo.png" alt="Logo" style="height: 30px; width: auto;">
                            <div class="company-name" style="font-size: 1rem; font-weight: 700;">POLYFOAM HIGH-TECH (PFH)</div>
                        </div>

                        <div class="form-title" style="flex: 2; display: flex; align-items: center; justify-content: center; padding: 10px; font-size: 1rem; font-weight: 700; text-align: center;">
                            ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏ô‡∏¥‡πà‡∏á‡πÄ‡∏°‡πá‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
                        </div>

                        <div style="flex: 1.5; padding: 6px 10px; display: flex; align-items: center; gap: 6px; font-size: 0.7rem;">
                            <b>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</b>
                            <select class="fmt02-month-select" style="padding: 2px 4px; border: 1px solid #000; font-size: 0.65rem;">
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                                ${thaiMonths.map((m, i) => `<option value="${i + 1}">${m}</option>`).join('')}
                            </select>
                            <select class="fmt02-year-select" style="padding: 2px 4px; border: 1px solid #000; font-size: 0.65rem;">
                                <option value="">‡∏õ‡∏µ</option>
                                ${Array.from({ length: 10 }, (_, i) => getCurrentThaiYear() - 5 + i).map(y => `<option value="${y}">${y}</option>`).join('')}
                            </select>
                            <b style="margin-left: auto;">FMT-03</b>
                            <b style="margin-left: 10px;">Re#0</b>
                        </div>
                    </div>
                    

                    <div style="display: flex; border: 1px solid #000; border-top: none; font-size: 0.8rem;">
                        <div style="flex: 1; padding: 6px 10px; border-right: 1px solid #000;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç / Machine No.: <span contenteditable="true" class="fmt02-m-no" style="border-bottom: 1px solid #000; display: inline-block; min-width: 80px;"></span></div>
                        <div style="flex: 1.5; padding: 6px 10px; border-right: 1px solid #000;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£/Machine Name : <span style="font-weight: bold;">PREEXPANDER FOAM</span></div>
                        <div style="flex: 1; padding: 6px 10px;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: <span style="font-weight: bold;">‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï 2<span></div>
                    </div>
                </div>

                <table class="main-table" style="font-size: 0.65rem; border-top: none; margin-top: 0;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width:130px;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                            <th rowspan="2" style="width:130px;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                            <th colspan="31">Date/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        </tr>
                        <tr>${dateHeaders}</tr>
                    </thead>
                    <tbody>${rowsHtml}</tbody>
                </table>
                <div style="border: 2px solid #000; border-top: none; padding: 0; margin-top: 0;">
                    <div style="display:flex;">
                        <div style="flex: 2; padding: 10px 15px; border-right: 2px solid #000; display: flex; flex-direction: column; gap: 8px;">
                            <div style="font-size: 0.85rem; font-weight: bold;">
                                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                            </div>
                            <div style="font-size: 0.75rem; line-height: 1.4;">
                                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </div>
                        </div>
                        <div style="flex: 1.2; padding: 0;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-top: none; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                    <td style="border: 1px solid #000; border-right: none; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                                </tr>
                                <tr style="height: 35px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000; border-right: none;"></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center; font-size: 0.65rem;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; border-right: none; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-bottom: none; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-right: none; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>`;
            document.getElementById('forms-container').appendChild(div);
        }
        function renderExactTable05() {
            const div = document.createElement('div');
            div.className = 'sheet-container';

            let dateHeaders = '';
            for (let i = 1; i <= 31; i++) {
                dateHeaders += `<th style="width: 20px; text-align: center; cursor: pointer" onclick="toggleColumn(${i})">${i}</th>`;
            }

            let rowsHtml = '';
            checklistData05.forEach(group => {
                // Category Header Row
                rowsHtml += `<tr style="background: #fdfdfd;">
                    <td colspan="2" style="text-align: left; font-weight: bold; padding-left: 5px; font-size: 0.8rem; height: 22px; border: 1px solid #000;">${group.category}</td>
                    ${Array(31).fill('<td style="border: 1px solid #000; background: #fafafa;"></td>').join('')}
                </tr>`;

                group.items.forEach((item, idx) => {
                    rowsHtml += `<tr>
                        <td class="col-item" style="font-size:0.75rem; padding-left: 15px; border: 1px solid #000;">${item.name}</td>
                        <td class="col-std" style="font-size:0.7rem; border: 1px solid #000;">${item.std}</td>`;
                    for (let i = 1; i <= 31; i++) {
                        rowsHtml += `<td class="check-cell mach-${i}" data-state="0" data-num="${i}" style="border: 1px solid #000;"></td>`;
                    }
                    rowsHtml += `</tr>`;
                });
            });

            div.innerHTML = `
                <div style="border-left: 1px solid #000; margin-bottom: 0;">
                    <div class="form-header" style="display: flex; align-items: stretch;">
                        <div class="logo-box" style="padding: 5px 15px; width: auto; flex: 1.2; display: flex; flex-direction: row; gap: 10px; align-items: center;">
                            <img src="Logo.png" alt="Logo" style="height: 30px; width: auto;">
                            <div class="company-name" style="font-size: 1rem; font-weight: 700;">POLYFOAM HIGH-TECH (PFH)</div>
                        </div>

                        <div class="form-title" style="flex: 2; display: flex; align-items: center; justify-content: center; padding: 10px; font-size: 1rem; font-weight: 700; text-align: center;">
                            ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏õ‡∏±‡πä‡∏°‡∏•‡∏°‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
                        </div>

                        <div style="flex: 1.5; padding: 6px 10px; display: flex; align-items: center; gap: 6px; font-size: 0.7rem;">
                            <b>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</b>
                            <select class="fmt02-month-select" style="padding: 2px 4px; border: 1px solid #000; font-size: 0.65rem;">
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                                ${thaiMonths.map((m, i) => `<option value="${i + 1}">${m}</option>`).join('')}
                            </select>
                            <select class="fmt02-year-select" style="padding: 2px 4px; border: 1px solid #000; font-size: 0.65rem;">
                                <option value="">‡∏õ‡∏µ</option>
                                ${Array.from({ length: 10 }, (_, i) => getCurrentThaiYear() - 5 + i).map(y => `<option value="${y}">${y}</option>`).join('')}
                            </select>
                            <b style="margin-left: auto;">FMT-05</b>
                            <b style="margin-left: 10px;">Re#0</b>
                        </div>
                    </div>
                    

                    <div style="display: flex; border: 1px solid #000; border-top: none; font-size: 0.8rem;">
                        <div style="flex: 1; padding: 6px 10px; border-right: 1px solid #000;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç / Machine No.: <span contenteditable="true" class="fmt02-m-no" style="border-bottom: 1px solid #000; display: inline-block; min-width: 80px;"></span></div>
                        <div style="flex: 1.5; padding: 6px 10px; border-right: 1px solid #000;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£/Machine Name : <span style="font-weight: bold;">‡∏õ‡∏±‡πä‡∏°‡∏•‡∏°</span></div>
                        <div style="flex: 1; padding: 6px 10px;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: <span style="font-weight: bold;">‡πÅ‡∏ó‡πà‡∏ô‡∏õ‡∏±‡πä‡∏°‡∏•‡∏°<span></div>
                    </div>
                </div>

                <table class="main-table" style="font-size: 0.65rem; border-top: none; margin-top: 0;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width:130px;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                            <th rowspan="2" style="width:130px;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                            <th colspan="31">Date/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        </tr>
                        <tr>${dateHeaders}</tr>
                    </thead>
                    <tbody>${rowsHtml}</tbody>
                </table>
                <div style="border: 2px solid #000; border-top: none; padding: 0; margin-top: 0;">
                    <div style="display:flex;">
                        <div style="flex: 2; padding: 10px 15px; border-right: 2px solid #000; display: flex; flex-direction: column; gap: 8px;">
                            <div style="font-size: 0.85rem; font-weight: bold;">
                                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                            </div>
                            <div style="font-size: 0.75rem; line-height: 1.4;">
                                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </div>
                        </div>
                        <div style="flex: 1.2; padding: 0;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-top: none; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                    <td style="border: 1px solid #000; border-right: none; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                                </tr>
                                <tr style="height: 35px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000; border-right: none;"></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center; font-size: 0.65rem;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; border-right: none; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-bottom: none; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-right: none; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>`;
            document.getElementById('forms-container').appendChild(div);
        }
        function renderExactTable06() {
            const div = document.createElement('div');
            div.className = 'sheet-container';

            let dateHeaders = '';
            for (let i = 1; i <= 31; i++) {
                dateHeaders += `<th style="width: 20px; text-align: center; cursor: pointer" onclick="toggleColumn(${i})">${i}</th>`;
            }

            let rowsHtml = '';
            checklistData06.forEach(group => {
                // Category Header Row
                rowsHtml += `<tr style="background: #fdfdfd;">
                    <td colspan="2" style="text-align: left; font-weight: bold; padding-left: 5px; font-size: 0.8rem; height: 22px; border: 1px solid #000;">${group.category}</td>
                    ${Array(31).fill('<td style="border: 1px solid #000; background: #fafafa;"></td>').join('')}
                </tr>`;

                group.items.forEach((item, idx) => {
                    rowsHtml += `<tr>
                        <td class="col-item" style="font-size:0.75rem; padding-left: 15px; border: 1px solid #000;">${item.name}</td>
                        <td class="col-std" style="font-size:0.7rem; border: 1px solid #000;">${item.std}</td>`;
                    for (let i = 1; i <= 31; i++) {
                        rowsHtml += `<td class="check-cell mach-${i}" data-state="0" data-num="${i}" style="border: 1px solid #000;"></td>`;
                    }
                    rowsHtml += `</tr>`;
                });
            });

            div.innerHTML = `
                <div style="border-left: 1px solid #000; margin-bottom: 0;">
                    <div class="form-header" style="display: flex; align-items: stretch;">
                        <div class="logo-box" style="padding: 5px 15px; width: auto; flex: 1.2; display: flex; flex-direction: row; gap: 10px; align-items: center;">
                            <img src="Logo.png" alt="Logo" style="height: 30px; width: auto;">
                            <div class="company-name" style="font-size: 1rem; font-weight: 700;">POLYFOAM HIGH-TECH (PFH)</div>
                        </div>

                        <div class="form-title" style="flex: 2; display: flex; align-items: center; justify-content: center; padding: 10px; font-size: 1rem; font-weight: 700; text-align: center;">
                            ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏õ‡∏±‡πä‡∏°‡∏™‡∏π‡∏ç‡∏ç‡∏≤‡∏Å‡∏≤‡∏®‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
                        </div>

                        <div style="flex: 1.5; padding: 6px 10px; display: flex; align-items: center; gap: 6px; font-size: 0.7rem;">
                            <b>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</b>
                            <select class="fmt02-month-select" style="padding: 2px 4px; border: 1px solid #000; font-size: 0.65rem;">
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                                ${thaiMonths.map((m, i) => `<option value="${i + 1}">${m}</option>`).join('')}
                            </select>
                            <select class="fmt02-year-select" style="padding: 2px 4px; border: 1px solid #000; font-size: 0.65rem;">
                                <option value="">‡∏õ‡∏µ</option>
                                ${Array.from({ length: 10 }, (_, i) => getCurrentThaiYear() - 5 + i).map(y => `<option value="${y}">${y}</option>`).join('')}
                            </select>
                            <b style="margin-left: auto;">FMT-06</b>
                            <b style="margin-left: 10px;">Re#0</b>
                        </div>
                    </div>
                    

                    <div style="display: flex; border: 1px solid #000; border-top: none; font-size: 0.8rem;">
                        <div style="flex: 1; padding: 6px 10px; border-right: 1px solid #000;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç / Machine No.: <span contenteditable="true" class="fmt02-m-no" style="border-bottom: 1px solid #000; display: inline-block; min-width: 80px;"></span></div>
                        <div style="flex: 1.5; padding: 6px 10px; border-right: 1px solid #000;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£/Machine Name : <span style="font-weight: bold;">‡∏õ‡∏±‡πä‡∏°‡∏™‡∏π‡∏ç‡∏ç‡∏≤‡∏Å‡∏≤‡∏®</span></div>
                        <div style="flex: 1; padding: 6px 10px;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: <span style="font-weight: bold;">‡∏Ç‡πâ‡∏≤‡∏á‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï 1<span></div>
                    </div>
                </div>

                <table class="main-table" style="font-size: 0.65rem; border-top: none; margin-top: 0;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width:130px;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                            <th rowspan="2" style="width:130px;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                            <th colspan="31">Date/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        </tr>
                        <tr>${dateHeaders}</tr>
                    </thead>
                    <tbody>${rowsHtml}</tbody>
                </table>
                <div style="border: 2px solid #000; border-top: none; padding: 0; margin-top: 0;">
                    <div style="display:flex;">
                        <div style="flex: 2; padding: 10px 15px; border-right: 2px solid #000; display: flex; flex-direction: column; gap: 8px;">
                            <div style="font-size: 0.85rem; font-weight: bold;">
                                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                            </div>
                            <div style="font-size: 0.75rem; line-height: 1.4;">
                                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </div>
                        </div>
                        <div style="flex: 1.2; padding: 0;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-top: none; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                    <td style="border: 1px solid #000; border-right: none; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                                </tr>
                                <tr style="height: 35px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000; border-right: none;"></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center; font-size: 0.65rem;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; border-right: none; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-bottom: none; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-right: none; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>`;
            document.getElementById('forms-container').appendChild(div);
        }
        function renderExactTable38() {
            const div = document.createElement('div');
            div.className = 'sheet-container';

            let dateHeaders = '';
            for (let i = 1; i <= 31; i++) {
                dateHeaders += `<th style="width: 20px; text-align: center; cursor: pointer" onclick="toggleColumn(${i})">${i}</th>`;
            }

            let rowsHtml = '';
            checklistData02.forEach(group => {
                // Category Header Row
                rowsHtml += `<tr style="background: #fdfdfd;">
                    <td colspan="2" style="text-align: left; font-weight: bold; padding-left: 5px; font-size: 0.8rem; height: 22px; border: 1px solid #000;">${group.category}</td>
                    ${Array(31).fill('<td style="border: 1px solid #000; background: #fafafa;"></td>').join('')}
                </tr>`;

                group.items.forEach((item, idx) => {
                    rowsHtml += `<tr>
                        <td class="col-item" style="font-size:0.75rem; padding-left: 15px; border: 1px solid #000;">${item.name}</td>
                        <td class="col-std" style="font-size:0.7rem; border: 1px solid #000;">${item.std}</td>`;
                    for (let i = 1; i <= 31; i++) {
                        rowsHtml += `<td class="check-cell mach-${i}" data-state="0" data-num="${i}" style="border: 1px solid #000;"></td>`;
                    }
                    rowsHtml += `</tr>`;
                });
            });

            const thaiDate = new Date().toLocaleDateString('th-TH', { year: 'numeric', month: 'long' });

            div.innerHTML = `
                <div style="border-left: 1px solid #000; margin-bottom: 0;">
                    <div class="form-header"  display: flex; align-items: stretch;">
                        <div class="logo-box" style="padding: 5px 15px; width: auto; flex: 1.2; display: flex; flex-direction: row; gap: 10px; align-items: center;">
                            <img src="Logo.png" alt="Logo" style="height: 30px; width: auto;">
                            <div class="company-name" style="font-size: 1rem; font-weight: 700;">POLYFOAM HIGH-TECH (PFH)</div>
                        </div>

                        <div class="form-title" style="flex: 2; display: flex; align-items: center; justify-content: center; padding: 10px; font-size: 1rem; font-weight: 700; text-align: center;">
                            ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£ ‡∏£‡∏≠‡∏Å‡πÑ‡∏ü‡∏ü‡πâ‡∏≤
                        </div>

                        <div style="flex: 1.2; padding: 6px 10px; display: flex; align-items: center; gap: 6px; font-size: 0.7rem;">
                            <b>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</b>
                            <select class="fmt38-month-select" style="padding: 2px 4px; border: 1px solid #000; font-size: 0.65rem;">
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                                ${thaiMonths.map((m, i) => `<option value="${i + 1}">${m}</option>`).join('')}
                            </select>
                            <select class="fmt38-year-select" style="padding: 2px 4px; border: 1px solid #000; font-size: 0.65rem;">
                                <option value="">‡∏õ‡∏µ</option>
                                ${Array.from({ length: 10 }, (_, i) => getCurrentThaiYear() - 5 + i).map(y => `<option value="${y}">${y}</option>`).join('')}
                            </select>
                            <b style="margin-left: auto;">FMT-38</b>
                            <b style="margin-left: 10px;">Re:#0</b>
                        </div>
                    </div>
                    

                    <div style="display: flex; border-bottom: 1px solid #000; font-size: 0.8rem;">
                        <div style="flex: 1; padding: 6px 10px; border-right: 1px solid #000;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç / Machine No.: <span contenteditable="true" class="fmt38-m-no" style="border-bottom: 1px solid #000; display: inline-block; min-width: 80px;"></span></div>
                        <div style="flex: 1.5; padding: 6px 10px; border-right: 1px solid #000;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£/Machine Name : <span style="font-weight: bold;"> </span></div>
                        <div style="flex: 1; padding: 6px 10px; border-right: 1px solid #000;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: <span style="font-weight: bold;"> <span></div>
                        

                    </div>
                </div>

                <table class="main-table" style="font-size: 0.65rem; border-top: none;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width:130px;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                            <th rowspan="2" style="width:130px;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                            <th colspan="31">Date/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        </tr>
                        <tr>${dateHeaders}</tr>
                    </thead>
                    <tbody>${rowsHtml}</tbody>
                </table>
                <div style="border: 2px solid #000; border-top: none; padding: 0; margin-top: 0;">
                    <div style="display:flex;">
                        <div style="flex: 2; padding: 10px 15px; border-right: 2px solid #000; display: flex; flex-direction: column; gap: 8px;">
                            <div style="font-size: 0.85rem; font-weight: bold;">
                                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                            </div>
                            <div style="font-size: 0.75rem; line-height: 1.4;">
                                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡∏•‡∏ß‡πÑ‡∏´‡∏•‡∏´‡∏•‡∏±‡πà‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </div>
                        </div>
                        <div style="flex: 1.2; padding: 0;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-top: none; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                    <td style="border: 1px solid #000; border-right: none; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                                </tr>
                                <tr style="height: 35px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000; border-right: none;"></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center; font-size: 0.65rem;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; border-right: none; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-bottom: none; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-right: none; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>`;
            document.getElementById('forms-container').appendChild(div);
        }
        function toggle(cell) {
            if (!isDragging) {
                setCellState(cell, (parseInt(cell.dataset.state) + 1) % 4);
            }
        }

        function setCellState(cell, state) {
            cell.dataset.state = state;
            cell.classList.remove('status-ok', 'status-bad', 'status-na');
            if (state === 1) { cell.textContent = "/"; cell.classList.add('status-ok'); }
            else if (state === 2) { cell.textContent = "X"; cell.classList.add('status-bad'); }
            else { cell.textContent = ""; }
        }

        // Drag-to-fill handlers
        document.addEventListener('mousedown', (e) => {
            if (e.target.classList.contains('check-cell')) {
                isDragging = true;
                dragStartCell = e.target;
                dragStartState = (parseInt(e.target.dataset.state) + 1) % 4;
                setCellState(e.target, dragStartState);
                e.preventDefault();
            }
        });

        document.addEventListener('mousemove', (e) => {
            if (isDragging && e.target.classList.contains('check-cell')) {
                setCellState(e.target, dragStartState);
            }
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            dragStartCell = null;
        });

        function toggleColumn(num) {
            const cells = document.querySelectorAll(`.mach-${num}`);
            if (!cells.length) return;
            let nextState = (parseInt(cells[0].dataset.state) + 1) % 4;
            cells.forEach(cell => setCellState(cell, nextState));
        }

        function saveToHistory() {
            document.getElementById('modalInput').value = "‡∏£‡∏≠‡∏ö‡∏ï‡∏£‡∏ß‡∏à " + new Date().toLocaleDateString('th-TH');
            document.getElementById('saveModal').style.display = 'flex';
        }

        function confirmSaveHistory() {
            const label = document.getElementById('modalInput').value.trim();
            if (!label) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠");

            const cellStates = Array.from(document.querySelectorAll('.check-cell')).map(c => ({ num: c.dataset.num, state: c.dataset.state }));
            const logData = Array.from(document.querySelectorAll('.log-cell')).map(c => c.textContent);
            const summaryWater = document.querySelector('.summary-water')?.textContent || '';
            const fmt01Date = document.querySelector('.fmt01-date')?.value || '';
            const rowRemarks = Array.from(document.querySelectorAll('.row-remark')).map(el => el.textContent);
            const remarks = Array.from(document.querySelectorAll('.correction-input')).map(el => el.textContent);
            const sigDates = Array.from(document.querySelectorAll('.date-input')).map(el => el.value);
            const sigNames = Array.from(document.querySelectorAll('.sig-name')).map(el => el.textContent);

            let metadata = {};
            if (currentFMT === 2 || currentFMT === 3 || currentFMT === 5 || currentFMT === 6 || currentFMT === 38) {
                const monthSelect = document.querySelector('.fmt02-month-select');
                const yearSelect = document.querySelector('.fmt02-year-select');

                metadata = {
                    month: monthSelect ? monthSelect.value : '',
                    year: yearSelect ? yearSelect.value : '',
                    mNo: document.querySelector('.fmt02-m-no')?.textContent || '',
                    mName: document.querySelector('.fmt02-m-name') ? document.querySelector('.fmt02-m-name').textContent : '',
                    area: document.querySelector('.fmt02-area') ? document.querySelector('.fmt02-area').textContent : '',
                    dept: document.querySelector('.fmt02-dept') ? document.querySelector('.fmt02-dept').textContent : ''
                };
            }

            const entry = {
                id: Date.now(),
                fmt: currentFMT,
                label,
                timestamp: new Date().toLocaleString('th-TH'),
                data: cellStates,
                logData,
                summaryWater,
                fmt01Date,
                rowRemarks,
                remarks,
                sigDates,
                sigNames,
                metadata
            };
            let history = JSON.parse(localStorage.getItem('fmt_history') || '[]');
            history.unshift(entry);
            localStorage.setItem('fmt_history', JSON.stringify(history));

            // Prepare data for Google Sheet (Flat Format)
            const checksArr = cellStates.map(c => parseInt(c.state));
            const sheetData = {
                id: entry.id,
                fmt: entry.fmt,
                date: new Date().toLocaleDateString('th-TH'),
                inspector: entry.label,
                checks: checksArr,
                corrections: remarks,
                dates: sigDates,
                rowRemarks: rowRemarks,
                jobName: entry.label,
                metadata: entry.metadata
            };
            sendToGoogleSheet(sheetData);

            document.getElementById('saveModal').style.display = 'none';
            renderHistoryList();
        }

        function renderHistoryList() {
            const container = document.getElementById('history-list');
            let history = JSON.parse(localStorage.getItem('fmt_history') || '[]');
            // Filter by current FMT
            history = history.filter(h => h.fmt === currentFMT || (currentFMT === 37 && !h.fmt));
            container.innerHTML = history.length === 0 ? '<div style="color:#94a3b8; font-size:0.8rem; text-align:center; padding:20px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>' : '';
            history.forEach(item => {
                const div = document.createElement('div');
                div.className = 'history-item';
                div.innerHTML = `
                    <input type="checkbox" class="item-checkbox" data-id="${item.id}" onclick="event.stopPropagation(); handleSelectionChange()">
                    <div class="date">${toThaiDigits(item.label)}</div>
                    <div class="timestamp">${toThaiDigits(item.timestamp)}</div>
                    <button class="delete-btn" onclick="deleteHistory(${item.id}, event)">&times;</button>
                `;
                div.onclick = () => {
                    viewHistoryItem(item);
                };
                container.appendChild(div);
            });
            handleSelectionChange();
        }

        function toggleSelectAll(cb) {
            document.querySelectorAll('.item-checkbox').forEach(item => {
                item.checked = cb.checked;
            });
            handleSelectionChange();
        }

        function handleSelectionChange() {
            const checkedCount = document.querySelectorAll('.item-checkbox:checked').length;
            const totalCount = document.querySelectorAll('.item-checkbox').length;
            const printBtn = document.getElementById('printSelectedBtn');

            if (checkedCount > 0) {
                printBtn.style.display = 'flex';
                printBtn.innerHTML = `<span>üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (${checkedCount})</span>`;
            } else {
                printBtn.style.display = 'none';
            }

            document.getElementById('selectAll').checked = checkedCount === totalCount && totalCount > 0;
        }

        function printSelected() {
            const checkedIds = Array.from(document.querySelectorAll('.item-checkbox:checked')).map(cb => parseInt(cb.dataset.id));
            if (checkedIds.length === 0) return;

            const history = JSON.parse(localStorage.getItem('fmt_history') || '[]');
            const selectedItems = history.filter(h => checkedIds.includes(h.id));

            const printArea = document.getElementById('print-area');
            printArea.innerHTML = '';

            selectedItems.forEach(item => {
                const formHTML = generateFormHTMLFromData(item);
                printArea.innerHTML += formHTML;
            });

            window.print();
            printArea.innerHTML = '';
        }

        function generateFormHTMLFromData(item) {
            if (item.fmt === 1) return renderStaticForm01(item);
            if (item.fmt === 2) return renderStaticForm02(item);
            if (item.fmt === 3) return renderStaticForm03(item);
            if (item.fmt === 5) return renderStaticForm05(item);
            if (item.fmt === 6) return renderStaticForm06(item);
            if (item.fmt === 38) return renderStaticForm38(item);
            return renderStaticForm37(item);
        }

        function renderStaticForm37(item) {
            let fullHTML = '';
            const ranges = [1, 21, 41];

            ranges.forEach(start => {
                let machineHeaders = '';
                for (let i = 0; i < 20; i++) {
                    let num = start + i;
                    let isExist = num <= 54;
                    machineHeaders += `<th style="width: 28px; text-align: center; border: 1px solid #000;">${isExist ? num : ''}</th>`;
                }

                let rowsHtml = '';
                const itemsCount = checklistData37.reduce((a, g) => a + g.items.length, 0);
                let cellIndexOffset = 0;
                if (start == 21) cellIndexOffset = itemsCount * 20;
                if (start == 41) cellIndexOffset = itemsCount * 40;

                checklistData37.forEach(group => {
                    group.items.forEach((chkItem, idx) => {
                        const rowIdxInGroup = checklistData37.flatMap(g => g.items).indexOf(chkItem);
                        const tableIdx = ranges.indexOf(start);
                        const overallRowIdx = tableIdx * itemsCount + rowIdxInGroup;
                        const rowRemarkText = (item.rowRemarks && item.rowRemarks[overallRowIdx]) ? item.rowRemarks[overallRowIdx] : "";

                        rowsHtml += `<tr>
                            ${idx === 0 ? `<td rowspan="${group.items.length}" class="category-cell" style="width: 30px; border: 1px solid #000;"><div class="vertical-text" style="font-weight:bold; width: 20px;">${group.category}</div></td>` : ''}
                            <td class="col-item" style="font-size:0.75rem; width: 150px; border: 1px solid #000; text-align: left; padding-left: 5px;">${chkItem.name}</td>
                            <td class="col-std" style="font-size:0.7rem; width: 220px; border: 1px solid #000; text-align: left; padding-left: 5px;">${chkItem.std}</td>`;

                        for (let i = 0; i < 20; i++) {
                            let num = start + i;
                            let isExist = num <= 54;
                            let state = 0;
                            if (isExist) {
                                const cellIdxInItemData = cellIndexOffset + (rowIdxInGroup * 20) + i;
                                state = item.data[cellIdxInItemData] ? parseInt(item.data[cellIdxInItemData].state) : 0;
                            }

                            let content = "";
                            let cls = "";
                            if (state === 1) { content = "/"; cls = "status-ok"; }
                            else if (state === 2) { content = "X"; cls = "status-bad"; }
                            else if (state === 3) { content = "-"; cls = "status-na"; }

                            rowsHtml += `<td class="check-cell ${cls}" style="text-align:center; font-weight:800; border: 1px solid #000; width: 28px;">${content}</td>`;
                        }
                        rowsHtml += `<td style="border: 1px solid #000; font-size: 0.7rem; width: 60px;">${rowRemarkText}</td></tr>`;
                    });
                });

                const rangeIdx = ranges.indexOf(start);

                fullHTML += `
                <div class="sheet-container" style="page-break-after: always; margin-bottom: 20px;">
                    <table style="width: 100%; border-collapse: collapse; border: 1px solid #000; margin-bottom: 0;">
                        <tr>
                            <td style="width: 25%; border: 1px solid #000; padding: 5px; text-align: center;">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                                    <img src="Logo.png" alt="Logo" style="height: 30px;">
                                    <b style="font-size: 0.85rem;">POLYFOAM HIGH-TECH (PFH)</b>
                                </div>
                            </td>
                            <td style="width: 55%; border: 1px solid #000; padding: 5px; text-align: center; font-size: 1.1rem; font-weight: bold;">
                                ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®
                            </td>
                            <td style="width: 20%; border: 1px solid #000; padding: 5px; text-align: right; font-size: 0.7rem;">
                                ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà.. FMT-37Re#0
                            </td>
                        </tr>
                    </table>

                    <table class="main-table" style="margin-top: 0; border-top: none; width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr>
                                <th rowspan="2" style="width: 30px; border: 1px solid #000;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                                <th rowspan="2" style="width: 150px; border: 1px solid #000;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                                <th rowspan="2" style="width: 220px; border: 1px solid #000;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                                <th colspan="20" style="text-align: center; border: 1px solid #000;">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</th>
                                <th rowspan="2" style="width: 60px; border: 1px solid #000;">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                            </tr>
                            <tr>${machineHeaders}</tr>
                        </thead>
                        <tbody>${rowsHtml}</tbody>
                    </table>

                    <div style="border: 1px solid #000; border-top: none; padding: 5px; font-size: 0.75rem;">
                        ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                        <div style="min-height: 40px; border-bottom: 1px dashed #ccc; margin-top: 4px; padding: 4px;">${item.remarks[rangeIdx] || ''}</div>
                    </div>

                    <div style="display: flex; border: 1px solid #000; border-top: none;">
                        <div style="flex: 2; padding: 10px;">
                            <div style="font-weight: bold; margin-bottom: 8px;">
                                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                            </div>
                            <div style="font-size: 0.75rem; line-height: 1.4;">
                                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </div>
                        </div>
                        <div style="flex: 1.5; border-left: 1px solid #000;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                                <tr style="height: 25px;">
                                    <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                    <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                    <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                    <td style="border-bottom: 1px solid #000; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                                </tr>
                                <tr style="height: 35px;">
                                    <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                    <td style="border-right: 1px solid #000; border-bottom: 1px solid #000;"></td>
                                    <td style="border-right: 1px solid #000; border-bottom: 1px solid #000;"></td>
                                    <td style="border-bottom: 1px solid #000;"></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                    <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;">${item.sigNames ? (item.sigNames[rangeIdx * 3] || "") : ""}</td>
                                    <td style="border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;">${item.sigNames ? (item.sigNames[rangeIdx * 3 + 1] || "") : ""}</td>
                                    <td style="border-bottom: 1px solid #000; text-align: center;">${item.sigNames ? (item.sigNames[rangeIdx * 3 + 2] || "") : ""}</td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border-right: 1px solid #000; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td style="border-right: 1px solid #000; text-align: center;">${item.sigDates ? toThaiDateStr(item.sigDates[rangeIdx * 3] || "") : ""}</td>
                                    <td style="border-right: 1px solid #000; text-align: center;">${item.sigDates ? toThaiDateStr(item.sigDates[rangeIdx * 3 + 1] || "") : ""}</td>
                                    <td style="text-align: center;">${item.sigDates ? toThaiDateStr(item.sigDates[rangeIdx * 3 + 2] || "") : ""}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>`;
            });
            return fullHTML;
        }

        function renderStaticForm02(item) {
            let dateHeaders = '';
            for (let i = 1; i <= 31; i++) {
                dateHeaders += `<th style="width: 20px; text-align: center;">${i}</th>`;
            }

            let rowsHtml = '';
            checklistData02.forEach(group => {
                // Category Header Row
                rowsHtml += `<tr style="background: #fdfdfd;">
                    <td colspan="2" style="text-align: left; font-weight: bold; padding-left: 5px; font-size: 0.75rem; border: 1px solid #000;">${group.category}</td>
                    ${Array(31).fill('<td style="border: 1px solid #000;"></td>').join('')}
                </tr>`;

                group.items.forEach((chkItem, idx) => {
                    rowsHtml += `<tr>
                        <td class="col-item" style="font-size:0.65rem; padding-left: 15px; border: 1px solid #000;">${chkItem.name}</td>
                        <td class="col-std" style="font-size:0.65rem; border: 1px solid #000;">${chkItem.std}</td>`;
                    for (let i = 1; i <= 31; i++) {
                        const cellIdx = checklistData02.flatMap(g => g.items).indexOf(chkItem) * 31 + (i - 1);
                        const state = item.data[cellIdx] ? parseInt(item.data[cellIdx].state) : 0;
                        let content = "";
                        let cls = "";
                        if (state === 1) { content = "/"; cls = "status-ok"; }
                        else if (state === 2) { content = "X"; cls = "status-bad"; }

                        rowsHtml += `<td class="check-cell ${cls}" style="text-align:center; font-weight:800; border: 1px solid #000; width:22px;">${content}</td>`;
                    }
                    rowsHtml += `</tr>`;
                });
            });

            const mData = item.metadata || {};
            const monthText = mData.month && mData.year ? thaiMonths[parseInt(mData.month) - 1] + ' ' + mData.year : '................../..................';


            return `<div class="sheet-container" style="page-break-after: always; margin-bottom: 20px;">
                <div style="border: 2px solid #000; margin-bottom: 0;">
                    <div class="form-header" style="border: none; border-bottom: 2px solid #000;">
                        <div class="logo-box" style="border-right: 2px solid #000; padding: 8px 15px; width: auto; flex: 1; display: flex; flex-direction: row; gap: 10px; align-items: center;">
                            <img src="Logo.png" alt="Logo" style="height: 38px; width: auto;">
                            <div class="company-name" style="font-size: 1rem; font-weight: 700;">POLYFOAM HIGH-TECH (PFH)</div>
                        </div>
                        <div class="form-title" style="flex: 2; display: flex; align-items: center; justify-content: center; padding: 8px; border-right: 2px solid #000; font-size: 1rem; font-weight: 700; text-align: center;">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏â‡∏µ‡∏î‡πÇ‡∏ü‡∏°‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</div>
                        <div style="flex: 1.2; padding: 6px 10px; display: flex; align-items: center; gap: 6px; font-size: 0.7rem;">
                            <b>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</b> ${monthText}
                            <b style="margin-left: auto;">FMT-02</b>
                            <b style="margin-left: 10px;">Re:#0</b>
                        </div>
                    </div>
                    <div style="display: flex; border-bottom: 2px solid #000; font-size: 0.8rem;">
                        <div style="flex: 1.2; padding: 6px 10px; border-right: 2px solid #000;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç / Machine No.: <span style="border-bottom: 1px solid #000; display: inline-block; min-width: 80px;">${mData.mNo || ''}</span></div>
                        <div style="flex: 2; padding: 6px 10px; border-right: 2px solid #000;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£/Machine Name : <span style="font-weight: bold;">INJECTION MOLDING FOAM</span></div>
                        <div style="flex: 0.5; padding: 6px 10px; border-right: 1px solid #000;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: ${mData.area || ''}</div>
                        <div style="flex: 0.5; padding: 6px 10px;">‡πÅ‡∏ú‡∏ô‡∏Å‡∏ú‡∏•‡∏¥‡∏ï: ${mData.dept || ''}</div>
                    </div>
                </div>

                <table class="main-table" style="font-size:0.6rem; width:100%; border-top: none;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width:120px;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                            <th rowspan="2" style="width:120px;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                            <th colspan="31">Date/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        </tr>
                        <tr>${dateHeaders}</tr>
                    </thead>
                    <tbody>${rowsHtml}</tbody>
                </table>
                <div style="border: 2px solid #000; border-top: none; padding: 0; margin-top: 0;">
                    <div style="display:flex;">
                        <div style="flex: 2; padding: 10px 15px; border-right: 2px solid #000; display: flex; flex-direction: column; gap: 8px;">
                            <div style="font-size: 0.85rem; font-weight: bold;">
                                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                            </div>
                            <div style="font-size: 0.75rem; line-height: 1.4;">
                                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡∏•‡∏ß‡πÑ‡∏´‡∏•‡∏´‡∏•‡∏±‡πà‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </div>
                        </div>
                        <div style="flex: 1.2; padding: 0;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-top: none; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                    <td style="border: 1px solid #000; border-right: none; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                                </tr>
                                <tr style="height: 35px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000; border-right: none;"></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center; font-size: 0.65rem;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                    <td style="border: 1px solid #000; border-right: none; padding: 2px;"><span contenteditable="true" class="sig-name" style="display: block; outline: none; text-align: center;"></span></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-bottom: none; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                    <td style="border: 1px solid #000; border-right: none; border-bottom: none; text-align: center; padding: 2px;"><input type="date" class="date-input" style="width: 100%; border: none; text-align: center; font-size: 0.65rem;"></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        function renderStaticForm03(item) {
            let dateHeaders = '';
            for (let i = 1; i <= 31; i++) {
                dateHeaders += `<th style="width: 20px; text-align: center;">${i}</th>`;
            }

            let rowsHtml = '';
            checklistData03.forEach(group => {
                rowsHtml += `<tr style="background: #fdfdfd;">
                    <td colspan="2" style="text-align: left; font-weight: bold; padding-left: 5px; font-size: 0.75rem; border: 1px solid #000;">${group.category}</td>
                    ${Array(31).fill('<td style="border: 1px solid #000;"></td>').join('')}
                </tr>`;

                group.items.forEach((chkItem, idx) => {
                    rowsHtml += `<tr>
                        <td class="col-item" style="font-size:0.65rem; padding-left: 15px; border: 1px solid #000;">${chkItem.name}</td>
                        <td class="col-std" style="font-size:0.65rem; border: 1px solid #000;">${chkItem.std}</td>`;
                    for (let i = 1; i <= 31; i++) {
                        const cellIdx = checklistData03.flatMap(g => g.items).indexOf(chkItem) * 31 + (i - 1);
                        const state = item.data[cellIdx] ? parseInt(item.data[cellIdx].state) : 0;
                        let content = "";
                        let cls = "";
                        if (state === 1) { content = "/"; cls = "status-ok"; }
                        else if (state === 2) { content = "X"; cls = "status-bad"; }

                        rowsHtml += `<td class="check-cell ${cls}" style="text-align:center; font-weight:800; border: 1px solid #000; width:22px;">${content}</td>`;
                    }
                    rowsHtml += `</tr>`;
                });
            });

            const mData = item.metadata || {};
            const monthText = mData.month && mData.year ? thaiMonths[parseInt(mData.month) - 1] + ' ' + mData.year : '................../..................';

            return `<div class="sheet-container" style="page-break-after: always; margin-bottom: 20px;">
                <div style="border: 2px solid #000; margin-bottom: 0;">
                    <div class="form-header" style="border: none; border-bottom: 2px solid #000;">
                        <div class="logo-box" style="border-right: 2px solid #000; padding: 8px 15px; width: auto; flex: 1; display: flex; flex-direction: row; gap: 10px; align-items: center;">
                            <img src="Logo.png" alt="Logo" style="height: 38px; width: auto;">
                            <div class="company-name" style="font-size: 1rem; font-weight: 700;">POLYFOAM HIGH-TECH (PFH)</div>
                        </div>
                        <div class="form-title" style="flex: 2; display: flex; align-items: center; justify-content: center; padding: 8px; border-right: 2px solid #000; font-size: 1rem; font-weight: 700; text-align: center;">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏ô‡∏¥‡πà‡∏á‡πÄ‡∏°‡πá‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</div>
                        <div style="flex: 1.2; padding: 6px 10px; display: flex; align-items: center; gap: 6px; font-size: 0.7rem;">
                            <b>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</b> ${monthText}
                            <b style="margin-left: auto;">FMT-03</b>
                            <b style="margin-left: 10px;">Re#0</b>
                        </div>
                    </div>
                    <div style="display: flex; border-bottom: 2px solid #000; font-size: 0.8rem;">
                        <div style="flex: 1.2; padding: 6px 10px; border-right: 2px solid #000;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç / Machine No.: <span style="border-bottom: 1px solid #000; display: inline-block; min-width: 80px;">${mData.mNo || ''}</span></div>
                        <div style="flex: 2; padding: 6px 10px; border-right: 2px solid #000;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£/Machine Name : <span style="font-weight: bold;">PREEXPANDER FOAM</span></div>
                        <div style="flex: 1; padding: 6px 10px;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï 2</div>
                    </div>
                </div>

                <table class="main-table" style="font-size:0.6rem; width:100%; border-top: none;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width:120px;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                            <th rowspan="2" style="width:120px;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                            <th colspan="31">Date/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        </tr>
                        <tr>${dateHeaders}</tr>
                    </thead>
                    <tbody>${rowsHtml}</tbody>
                </table>
                <div style="border: 2px solid #000; border-top: none; padding: 0; margin-top: 0;">
                    <div style="display:flex;">
                        <div style="flex: 2; padding: 10px 15px; border-right: 2px solid #000; display: flex; flex-direction: column; gap: 8px;">
                            <div style="font-size: 0.85rem; font-weight: bold;">
                                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                            </div>
                            <div style="font-size: 0.75rem; line-height: 1.4;">
                                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </div>
                        </div>
                        <div style="flex: 1.2; padding: 0;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-top: none; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                    <td style="border: 1px solid #000; border-right: none; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                                </tr>
                                <tr style="height: 35px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000; border-right: none;"></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center; font-size: 0.65rem;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[0] || '' : ''}</span></td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[1] || '' : ''}</span></td>
                                    <td style="border: 1px solid #000; border-right: none; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[2] || '' : ''}</span></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-bottom: none; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[0] || '') : ''}</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[1] || '') : ''}</td>
                                    <td style="border: 1px solid #000; border-right: none; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[2] || '') : ''}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        function renderStaticForm05(item) {
            let dateHeaders = '';
            for (let i = 1; i <= 31; i++) {
                dateHeaders += `<th style="width: 20px; text-align: center;">${i}</th>`;
            }

            let rowsHtml = '';
            checklistData05.forEach(group => {
                rowsHtml += `<tr style="background: #fdfdfd;">
                    <td colspan="2" style="text-align: left; font-weight: bold; padding-left: 5px; font-size: 0.75rem; border: 1px solid #000;">${group.category}</td>
                    ${Array(31).fill('<td style="border: 1px solid #000;"></td>').join('')}
                </tr>`;

                group.items.forEach((chkItem, idx) => {
                    rowsHtml += `<tr>
                        <td class="col-item" style="font-size:0.65rem; padding-left: 15px; border: 1px solid #000;">${chkItem.name}</td>
                        <td class="col-std" style="font-size:0.65rem; border: 1px solid #000;">${chkItem.std}</td>`;
                    for (let i = 1; i <= 31; i++) {
                        const cellIdx = checklistData05.flatMap(g => g.items).indexOf(chkItem) * 31 + (i - 1);
                        const state = item.data[cellIdx] ? parseInt(item.data[cellIdx].state) : 0;
                        let content = "";
                        let cls = "";
                        if (state === 1) { content = "/"; cls = "status-ok"; }
                        else if (state === 2) { content = "X"; cls = "status-bad"; }

                        rowsHtml += `<td class="check-cell ${cls}" style="text-align:center; font-weight:800; border: 1px solid #000; width:22px;">${content}</td>`;
                    }
                    rowsHtml += `</tr>`;
                });
            });

            const mData = item.metadata || {};
            const monthText = mData.month && mData.year ? thaiMonths[parseInt(mData.month) - 1] + ' ' + mData.year : '................../..................';

            return `<div class="sheet-container" style="page-break-after: always; margin-bottom: 20px;">
                <div style="border: 2px solid #000; margin-bottom: 0;">
                    <div class="form-header" style="border: none; border-bottom: 2px solid #000;">
                        <div class="logo-box" style="border-right: 2px solid #000; padding: 8px 15px; width: auto; flex: 1; display: flex; flex-direction: row; gap: 10px; align-items: center;">
                            <img src="Logo.png" alt="Logo" style="height: 38px; width: auto;">
                            <div class="company-name" style="font-size: 1rem; font-weight: 700;">POLYFOAM HIGH-TECH (PFH)</div>
                        </div>
                        <div class="form-title" style="flex: 2; display: flex; align-items: center; justify-content: center; padding: 8px; border-right: 2px solid #000; font-size: 1rem; font-weight: 700; text-align: center;">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏õ‡∏±‡πä‡∏°‡∏•‡∏°‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</div>
                        <div style="flex: 1.2; padding: 6px 10px; display: flex; align-items: center; gap: 6px; font-size: 0.7rem;">
                            <b>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</b> ${monthText}
                            <b style="margin-left: auto;">FMT-05</b>
                            <b style="margin-left: 10px;">Re#0</b>
                        </div>
                    </div>
                    <div style="display: flex; border-bottom: 2px solid #000; font-size: 0.8rem;">
                        <div style="flex: 1.2; padding: 6px 10px; border-right: 2px solid #000;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç / Machine No.: <span style="border-bottom: 1px solid #000; display: inline-block; min-width: 80px;">${mData.mNo || ''}</span></div>
                        <div style="flex: 2; padding: 6px 10px; border-right: 2px solid #000;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£/Machine Name : <span style="font-weight: bold;">‡∏õ‡∏±‡πä‡∏°‡∏•‡∏°</span></div>
                        <div style="flex: 1; padding: 6px 10px;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: ‡πÅ‡∏ó‡πà‡∏ô‡∏õ‡∏±‡πä‡∏°‡∏•‡∏°</div>
                    </div>
                </div>

                <table class="main-table" style="font-size:0.6rem; width:100%; border-top: none;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width:120px;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                            <th rowspan="2" style="width:120px;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                            <th colspan="31">Date/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        </tr>
                        <tr>${dateHeaders}</tr>
                    </thead>
                    <tbody>${rowsHtml}</tbody>
                </table>
                <div style="border: 2px solid #000; border-top: none; padding: 0; margin-top: 0;">
                    <div style="display:flex;">
                        <div style="flex: 2; padding: 10px 15px; border-right: 2px solid #000; display: flex; flex-direction: column; gap: 8px;">
                            <div style="font-size: 0.85rem; font-weight: bold;">
                                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                            </div>
                            <div style="font-size: 0.75rem; line-height: 1.4;">
                                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </div>
                        </div>
                        <div style="flex: 1.2; padding: 0;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-top: none; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                    <td style="border: 1px solid #000; border-right: none; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                                </tr>
                                <tr style="height: 35px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000; border-right: none;"></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center; font-size: 0.65rem;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[0] || '' : ''}</span></td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[1] || '' : ''}</span></td>
                                    <td style="border: 1px solid #000; border-right: none; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[2] || '' : ''}</span></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-bottom: none; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[0] || '') : ''}</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[1] || '') : ''}</td>
                                    <td style="border: 1px solid #000; border-right: none; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[2] || '') : ''}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        function renderStaticForm06(item) {
            let dateHeaders = '';
            for (let i = 1; i <= 31; i++) {
                dateHeaders += `<th style="width: 20px; text-align: center;">${i}</th>`;
            }

            let rowsHtml = '';
            checklistData06.forEach(group => {
                rowsHtml += `<tr style="background: #fdfdfd;">
                    <td colspan="2" style="text-align: left; font-weight: bold; padding-left: 5px; font-size: 0.75rem; border: 1px solid #000;">${group.category}</td>
                    ${Array(31).fill('<td style="border: 1px solid #000;"></td>').join('')}
                </tr>`;

                group.items.forEach((chkItem, idx) => {
                    rowsHtml += `<tr>
                        <td class="col-item" style="font-size:0.65rem; padding-left: 15px; border: 1px solid #000;">${chkItem.name}</td>
                        <td class="col-std" style="font-size:0.65rem; border: 1px solid #000;">${chkItem.std}</td>`;
                    for (let i = 1; i <= 31; i++) {
                        const cellIdx = checklistData06.flatMap(g => g.items).indexOf(chkItem) * 31 + (i - 1);
                        const state = item.data[cellIdx] ? parseInt(item.data[cellIdx].state) : 0;
                        let content = "";
                        let cls = "";
                        if (state === 1) { content = "/"; cls = "status-ok"; }
                        else if (state === 2) { content = "X"; cls = "status-bad"; }

                        rowsHtml += `<td class="check-cell ${cls}" style="text-align:center; font-weight:800; border: 1px solid #000; width:22px;">${content}</td>`;
                    }
                    rowsHtml += `</tr>`;
                });
            });

            const mData = item.metadata || {};
            const monthText = mData.month && mData.year ? thaiMonths[parseInt(mData.month) - 1] + ' ' + mData.year : '................../..................';

            return `<div class="sheet-container" style="page-break-after: always; margin-bottom: 20px;">
                <div style="border: 2px solid #000; margin-bottom: 0;">
                    <div class="form-header" style="border: none; border-bottom: 2px solid #000;">
                        <div class="logo-box" style="border-right: 2px solid #000; padding: 8px 15px; width: auto; flex: 1; display: flex; flex-direction: row; gap: 10px; align-items: center;">
                            <img src="Logo.png" alt="Logo" style="height: 38px; width: auto;">
                            <div class="company-name" style="font-size: 1rem; font-weight: 700;">POLYFOAM HIGH-TECH (PFH)</div>
                        </div>
                        <div class="form-title" style="flex: 2; display: flex; align-items: center; justify-content: center; padding: 8px; border-right: 2px solid #000; font-size: 1rem; font-weight: 700; text-align: center;">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏õ‡∏±‡πä‡∏°‡∏™‡∏π‡∏ç‡∏ç‡∏≤‡∏Å‡∏≤‡∏®‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</div>
                        <div style="flex: 1.2; padding: 6px 10px; display: flex; align-items: center; gap: 6px; font-size: 0.7rem;">
                            <b>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</b> ${monthText}
                            <b style="margin-left: auto;">FMT-06</b>
                            <b style="margin-left: 10px;">Re#0</b>
                        </div>
                    </div>
                    <div style="display: flex; border-bottom: 2px solid #000; font-size: 0.8rem;">
                        <div style="flex: 1.2; padding: 6px 10px; border-right: 2px solid #000;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç / Machine No.: <span style="border-bottom: 1px solid #000; display: inline-block; min-width: 80px;">${mData.mNo || ''}</span></div>
                        <div style="flex: 2; padding: 6px 10px; border-right: 2px solid #000;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£/Machine Name : <span style="font-weight: bold;">‡∏õ‡∏±‡πä‡∏°‡∏™‡∏π‡∏ç‡∏ç‡∏≤‡∏Å‡∏≤‡∏®</span></div>
                        <div style="flex: 1; padding: 6px 10px;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: ‡∏Ç‡πâ‡∏≤‡∏á‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï 1</div>
                    </div>
                </div>

                <table class="main-table" style="font-size:0.6rem; width:100%; border-top: none;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width:120px;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                            <th rowspan="2" style="width:120px;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                            <th colspan="31">Date/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        </tr>
                        <tr>${dateHeaders}</tr>
                    </thead>
                    <tbody>${rowsHtml}</tbody>
                </table>
                <div style="border: 2px solid #000; border-top: none; padding: 0; margin-top: 0;">
                    <div style="display:flex;">
                        <div style="flex: 2; padding: 10px 15px; border-right: 2px solid #000; display: flex; flex-direction: column; gap: 8px;">
                            <div style="font-size: 0.85rem; font-weight: bold;">
                                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                            </div>
                            <div style="font-size: 0.75rem; line-height: 1.4;">
                                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </div>
                        </div>
                        <div style="flex: 1.2; padding: 0;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-top: none; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                    <td style="border: 1px solid #000; border-right: none; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                                </tr>
                                <tr style="height: 35px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000; border-right: none;"></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center; font-size: 0.65rem;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[0] || '' : ''}</span></td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[1] || '' : ''}</span></td>
                                    <td style="border: 1px solid #000; border-right: none; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[2] || '' : ''}</span></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-bottom: none; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[0] || '') : ''}</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[1] || '') : ''}</td>
                                    <td style="border: 1px solid #000; border-right: none; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[2] || '') : ''}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        function renderStaticForm38(item) {
            let dateHeaders = '';
            for (let i = 1; i <= 31; i++) {
                dateHeaders += `<th style="width: 20px; text-align: center;">${i}</th>`;
            }

            let rowsHtml = '';
            checklistData38.forEach(group => {
                rowsHtml += `<tr style="background: #fdfdfd;">
                    <td colspan="2" style="text-align: left; font-weight: bold; padding-left: 5px; font-size: 0.75rem; border: 1px solid #000;">${group.category}</td>
                    ${Array(31).fill('<td style="border: 1px solid #000;"></td>').join('')}
                </tr>`;

                group.items.forEach((chkItem, idx) => {
                    rowsHtml += `<tr>
                        <td class="col-item" style="font-size:0.65rem; padding-left: 15px; border: 1px solid #000;">${chkItem.name}</td>
                        <td class="col-std" style="font-size:0.65rem; border: 1px solid #000;">${chkItem.std}</td>`;
                    for (let i = 1; i <= 31; i++) {
                        const cellIdx = checklistData38.flatMap(g => g.items).indexOf(chkItem) * 31 + (i - 1);
                        const state = item.data[cellIdx] ? parseInt(item.data[cellIdx].state) : 0;
                        let content = "";
                        let cls = "";
                        if (state === 1) { content = "/"; cls = "status-ok"; }
                        else if (state === 2) { content = "X"; cls = "status-bad"; }

                        rowsHtml += `<td class="check-cell ${cls}" style="text-align:center; font-weight:800; border: 1px solid #000; width:22px;">${content}</td>`;
                    }
                    rowsHtml += `</tr>`;
                });
            });

            const mData = item.metadata || {};
            const monthText = mData.month && mData.year ? thaiMonths[parseInt(mData.month) - 1] + ' ' + mData.year : '................../..................';

            return `<div class="sheet-container" style="page-break-after: always; margin-bottom: 20px;">
                <div style="border: 2px solid #000; margin-bottom: 0;">
                    <div class="form-header" style="border: none; border-bottom: 2px solid #000;">
                        <div class="logo-box" style="border-right: 2px solid #000; padding: 8px 15px; width: auto; flex: 1; display: flex; flex-direction: row; gap: 10px; align-items: center;">
                            <img src="Logo.png" alt="Logo" style="height: 38px; width: auto;">
                            <div class="company-name" style="font-size: 1rem; font-weight: 700;">POLYFOAM HIGH-TECH (PFH)</div>
                        </div>
                        <div class="form-title" style="flex: 2; display: flex; align-items: center; justify-content: center; padding: 8px; border-right: 2px solid #000; font-size: 1rem; font-weight: 700; text-align: center;">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£ ‡∏£‡∏≠‡∏Å‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</div>
                        <div style="flex: 1.2; padding: 6px 10px; display: flex; align-items: center; gap: 6px; font-size: 0.7rem;">
                            <b>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</b> ${monthText}
                            <b style="margin-left: auto;">FMT-38</b>
                            <b style="margin-left: 10px;">Re#0</b>
                        </div>
                    </div>
                    <div style="display: flex; border-bottom: 2px solid #000; font-size: 0.8rem;">
                        <div style="flex: 1.2; padding: 6px 10px; border-right: 2px solid #000;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç / Machine No.: <span style="border-bottom: 1px solid #000; display: inline-block; min-width: 80px;">${mData.mNo || ''}</span></div>
                        <div style="flex: 2; padding: 6px 10px; border-right: 2px solid #000;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£/Machine Name : <span style="font-weight: bold;">${mData.mName || '‡∏£‡∏≠‡∏Å‡πÑ‡∏ü‡∏ü‡πâ‡∏≤'}</span></div>
                        <div style="flex: 1; padding: 6px 10px;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: ${mData.area || ''}</div>
                    </div>
                </div>

                <table class="main-table" style="font-size:0.6rem; width:100%; border-top: none;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width:120px;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</th>
                            <th rowspan="2" style="width:120px;">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                            <th colspan="31">Date/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        </tr>
                        <tr>${dateHeaders}</tr>
                    </thead>
                    <tbody>${rowsHtml}</tbody>
                </table>
                <div style="border: 2px solid #000; border-top: none; padding: 0; margin-top: 0;">
                    <div style="display:flex;">
                        <div style="flex: 2; padding: 10px 15px; border-right: 2px solid #000; display: flex; flex-direction: column; gap: 8px;">
                            <div style="font-size: 0.85rem; font-weight: bold;">
                                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ &nbsp;&nbsp;&nbsp; ‡∏£‡∏∞‡∏ö‡∏∏ &nbsp; / &nbsp; ‡∏õ‡∏Å‡∏ï‡∏¥ &nbsp;&nbsp; X &nbsp;&nbsp; ‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥
                            </div>
                            <div style="font-size: 0.75rem; line-height: 1.4;">
                                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏à‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </div>
                        </div>
                        <div style="flex: 1.2; padding: 0;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.7rem;">
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-top: none; text-align: center; width: 60px;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</td>
                                    <td style="border: 1px solid #000; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</td>
                                    <td style="border: 1px solid #000; border-right: none; border-top: none; text-align: center;">‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
                                </tr>
                                <tr style="height: 35px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center;">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000;"></td>
                                    <td style="border: 1px solid #000; border-right: none;"></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; text-align: center; font-size: 0.65rem;">‡∏ä‡∏∑‡πà‡∏≠ (‡∏ï‡∏±‡∏ß‡∏ö‡∏£‡∏£‡∏à‡∏á)</td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[0] || '' : ''}</span></td>
                                    <td style="border: 1px solid #000; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[1] || '' : ''}</span></td>
                                    <td style="border: 1px solid #000; border-right: none; padding: 2px;"><span style="display: block; text-align: center;">${item.sigNames ? item.sigNames[2] || '' : ''}</span></td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td style="border: 1px solid #000; border-left: none; border-bottom: none; text-align: center;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[0] || '') : ''}</td>
                                    <td style="border: 1px solid #000; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[1] || '') : ''}</td>
                                    <td style="border: 1px solid #000; border-right: none; border-bottom: none; text-align: center; padding: 2px;">${item.sigDates ? toThaiDateStr(item.sigDates[2] || '') : ''}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        function applyHistoryState(item) {
            clearAll();
            const cells = document.querySelectorAll('.check-cell');
            item.data.forEach((d, i) => { if (cells[i]) setCellState(cells[i], parseInt(d.state)); });

            if (item.fmt === 1 && item.logData) {
                const logCells = document.querySelectorAll('.log-cell');
                item.logData.forEach((val, i) => { if (logCells[i]) logCells[i].textContent = val; });
                if (document.querySelector('.summary-water')) document.querySelector('.summary-water').textContent = item.summaryWater || '';
                if (document.querySelector('.fmt01-date')) document.querySelector('.fmt01-date').value = item.fmt01Date || '';
            }
            const remarks = document.querySelectorAll('.correction-input');
            item.remarks.forEach((txt, i) => { if (remarks[i]) remarks[i].textContent = txt; });
            const sigNames = document.querySelectorAll('.sig-name');
            if (item.sigNames) {
                item.sigNames.forEach((val, i) => { if (sigNames[i]) sigNames[i].textContent = val; });
            }

            const dates = document.querySelectorAll('.date-input');
            item.sigDates.forEach((val, i) => {
                if (dates[i]) {
                    dates[i].value = val;
                    if (dates[i].previousElementSibling) {
                        dates[i].previousElementSibling.innerText = toThaiDateStr(val);
                    }
                }
            });

            const rowRemarks = document.querySelectorAll('.row-remark');
            if (item.rowRemarks) {
                item.rowRemarks.forEach((txt, i) => { if (rowRemarks[i]) rowRemarks[i].textContent = txt; });
            }

            if ((item.fmt === 2 || item.fmt === 3 || item.fmt === 5 || item.fmt === 6 || item.fmt === 38) && item.metadata) {
                if (document.querySelector('.fmt02-month-select')) document.querySelector('.fmt02-month-select').value = item.metadata.month || '';
                if (document.querySelector('.fmt02-year-select')) document.querySelector('.fmt02-year-select').value = item.metadata.year || '';
                if (document.querySelector('.fmt02-m-no')) document.querySelector('.fmt02-m-no').textContent = item.metadata.mNo || '';
                if (document.querySelector('.fmt02-m-name')) document.querySelector('.fmt02-m-name').textContent = item.metadata.mName || '';
                if (document.querySelector('.fmt02-area')) document.querySelector('.fmt02-area').textContent = item.metadata.area || '';
                if (document.querySelector('.fmt02-dept')) document.querySelector('.fmt02-dept').textContent = item.metadata.dept || '';
            }
        }

        function viewHistoryItem(item) {
            applyHistoryState(item);
            currentLoadedId = item.id;

            const badge = document.getElementById('statusBadge');
            badge.style.display = 'block';
            badge.style.background = '#e0f2fe';
            badge.style.color = '#0369a1';
            badge.style.borderColor = '#bae6fd';
            badge.innerText = `üëÄ Viewing: ${item.label}`;

            document.getElementById('editToggleBtn').style.display = 'flex';
            document.getElementById('updateBtn').style.display = 'none';
        }
        function toggleEditMode() {
            if (!currentLoadedId) return;
            const badge = document.getElementById('statusBadge');
            badge.style.background = '#fee2e2';
            badge.style.color = '#991b1b';
            badge.style.borderColor = '#fecaca';
            badge.innerText = `‚úèÔ∏è Editing: ${document.getElementById('statusBadge').innerText.replace('üëÄ Viewing: ', '')}`;

            document.getElementById('editToggleBtn').style.display = 'none';
            document.getElementById('updateBtn').style.display = 'flex';
        }

        function updateCurrentHistory() {
            if (!currentLoadedId) return;
            let history = JSON.parse(localStorage.getItem('fmt_history') || '[]');
            const idx = history.findIndex(h => h.id === currentLoadedId);
            if (idx === -1) return;

            history[idx].data = Array.from(document.querySelectorAll('.check-cell')).map(c => ({ num: c.dataset.num, state: c.dataset.state }));
            history[idx].rowRemarks = Array.from(document.querySelectorAll('.row-remark')).map(el => el.textContent);
            history[idx].remarks = Array.from(document.querySelectorAll('.correction-input')).map(el => el.textContent);
            history[idx].sigDates = Array.from(document.querySelectorAll('.date-input')).map(el => el.value);
            history[idx].timestamp = new Date().toLocaleString('th-TH') + " (Updated)";

            localStorage.setItem('fmt_history', JSON.stringify(history));

            // Send to Google Sheet
            const checksArr = history[idx].data.map(c => parseInt(c.state));
            const sheetData = {
                id: history[idx].id,
                fmt: history[idx].fmt,
                date: new Date().toLocaleDateString('th-TH'),
                inspector: history[idx].label,
                checks: checksArr,
                corrections: history[idx].remarks,
                dates: history[idx].sigDates,
                rowRemarks: history[idx].rowRemarks,
                jobName: history[idx].label,
                metadata: history[idx].metadata
            };
            sendToGoogleSheet(sheetData);

            alert("‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
            renderHistoryList();
            document.getElementById('updateBtn').style.display = 'none';
            document.getElementById('statusBadge').style.display = 'none';
            document.getElementById('editToggleBtn').style.display = 'none';
            currentLoadedId = null;
            clearAll();
        }

        function deleteHistory(id, event) {
            event.stopPropagation();
            if (!confirm("‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ?")) return;
            let history = JSON.parse(localStorage.getItem('fmt_history') || '[]');
            history = history.filter(h => h.id !== id);
            localStorage.setItem('fmt_history', JSON.stringify(history));
            renderHistoryList();
            if (currentLoadedId === id) {
                currentLoadedId = null;
                document.getElementById('statusBadge').style.display = 'none';
                document.getElementById('updateBtn').style.display = 'none';
            }
        }

        function markAllNormal() {
            document.querySelectorAll('.check-cell').forEach(c => {
                if (currentFMT === 37) {
                    const num = parseInt(c.dataset.num);
                    if (num <= 54 && c.dataset.state == '0') setCellState(c, 1);
                } else {
                    if (c.dataset.state == '0') setCellState(c, 1);
                }
            });
        }

        async function syncFromCloud() {
            const btn = document.querySelector('button[title="‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Cloud"]');
            if (btn) {
                btn.innerHTML = '‚è≥...';
                btn.disabled = true;
            }

            try {
                // Assuming the Script returns a JSON list of objects
                const response = await fetch(GOOGLE_SCRIPT_URL);
                if (!response.ok) throw new Error("Network response was not ok");
                const cloudData = await response.json();

                if (!Array.isArray(cloudData)) throw new Error("Invalid data format");

                let localHistory = JSON.parse(localStorage.getItem('fmt_history') || '[]');
                let newCount = 0;

                cloudData.forEach(cItem => {
                    // Check if exists
                    if (!localHistory.some(h => h.id == cItem.id)) {
                        try {
                            // Convert format
                            const appItem = {
                                id: parseInt(cItem.id) || Date.now(),
                                fmt: parseInt(cItem.fmt) || 2, // Default to 2 if missing
                                label: cItem.jobName || cItem.inspector || "No Name",
                                timestamp: cItem.date || new Date().toLocaleString('th-TH'),
                                data: (cItem.checks || []).map(s => ({ state: s })),
                                rowRemarks: cItem.rowRemarks || [],
                                remarks: cItem.corrections || [],
                                sigDates: cItem.dates || [],
                                sigNames: [], // Sheet might not have this, leave empty
                                metadata: cItem.metadata || {}
                            };
                            localHistory.push(appItem);
                            newCount++;
                        } catch (e) {
                            console.error("Error parsing item:", cItem, e);
                        }
                    }
                });

                if (newCount > 0) {
                    // Sort descending by id (timestamp)
                    localHistory.sort((a, b) => b.id - a.id);
                    localStorage.setItem('fmt_history', JSON.stringify(localHistory));
                    renderHistoryList();
                    alert(`‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡πÄ‡∏û‡∏¥‡πà‡∏° ${newCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà`);
                } else {
                    alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß");
                }

            } catch (err) {
                console.error(err);
                alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: " + err.message);
            } finally {
                if (btn) {
                    btn.innerHTML = '‚òÅÔ∏è Sync';
                    btn.disabled = false;
                }
            }
        }

        function clearAll() {
            document.querySelectorAll('.check-cell').forEach(c => setCellState(c, 0));
            document.querySelectorAll('.correction-input').forEach(el => el.textContent = '');
            document.querySelectorAll('.date-input').forEach(el => el.value = '');
        }

        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏´‡∏°‡πà ---

        // 1. ‡∏ß‡∏≤‡∏á URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy ‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbytCloKMouYV4Mdkp_Ar0yyjIloCz4VRCbdSkNKDhf8fEkV5Bym9Cthz9-XX4uNkEsd/exec";

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheet
        async function sendToGoogleSheet(data) {
            const saveBtn = document.querySelector('.btn-primary');
            try {
                saveBtn.disabled = true;
                // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö POST
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: "POST",
                    mode: "no-cors",
                    headers: { "Content-Type": "text/plain" },
                    body: JSON.stringify(data)
                });
                alert("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Google Sheet ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
            } catch (err) {
                alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err.message);
            } finally {
                saveBtn.disabled = false;
            }
        }

        // Draggable Controls
        const controls = document.querySelector('.controls');
        let isDraggingControls = false;
        let dragOffsetX = 0;
        let dragOffsetY = 0;

        controls.addEventListener('mousedown', (e) => {
            if (!e.target.closest('.drag-handle-bar')) return;

            isDraggingControls = true;

            const rect = controls.getBoundingClientRect();
            dragOffsetX = e.clientX - rect.left;
            dragOffsetY = e.clientY - rect.top;

            controls.style.right = 'auto'; // Disable 'right' so 'left' takes over
            controls.style.left = rect.left + 'px';
            controls.style.top = rect.top + 'px';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDraggingControls) return;
            e.preventDefault();

            const x = e.clientX - dragOffsetX;
            const y = e.clientY - dragOffsetY;

            const maxX = window.innerWidth - controls.offsetWidth;
            const maxY = window.innerHeight - controls.offsetHeight;

            controls.style.left = Math.max(0, Math.min(x, maxX)) + 'px';
            controls.style.top = Math.max(0, Math.min(y, maxY)) + 'px';
        });

        document.addEventListener('mouseup', () => {
            isDraggingControls = false;
        });

        // Touch support for mobile
        controls.addEventListener('touchstart', (e) => {
            if (!e.target.closest('.drag-handle-bar')) return;

            isDraggingControls = true;
            const touch = e.touches[0];
            const rect = controls.getBoundingClientRect();
            dragOffsetX = touch.clientX - rect.left;
            dragOffsetY = touch.clientY - rect.top;

            controls.style.right = 'auto';
            controls.style.left = rect.left + 'px';
            controls.style.top = rect.top + 'px';
        }, { passive: false });

        document.addEventListener('touchmove', (e) => {
            if (!isDraggingControls) return;
            const touch = e.touches[0];

            // Check if touch is on handle to decide prevention strictly?
            // Actually, keep preventDefault only if dragging to avoid scrolling while moving the modal
            if (e.cancelable) e.preventDefault();

            const x = touch.clientX - dragOffsetX;
            const y = touch.clientY - dragOffsetY;

            const maxX = window.innerWidth - controls.offsetWidth;
            const maxY = window.innerHeight - controls.offsetHeight;

            controls.style.left = Math.max(0, Math.min(x, maxX)) + 'px';
            controls.style.top = Math.max(0, Math.min(y, maxY)) + 'px';
        }, { passive: false });

        document.addEventListener('touchend', () => {
            isDraggingControls = false;
        });

    </script>

</body>

</html>